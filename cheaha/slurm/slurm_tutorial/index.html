
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../introduction/">
      
      
        <link rel="next" href="../submitting_jobs/">
      
      
      <link rel="icon" href="../../../images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.0, mkdocs-material-9.5.4">
    
    
      
        <title>Slurm Tutorial - Research Computing Documentation</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.50c56a3b.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../stylesheets/extra.css">
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
   <link href="../../../assets/stylesheets/glightbox.min.css" rel="stylesheet"/><style>
    html.glightbox-open { overflow: initial; height: 100%; }
    .gslide-title { margin-top: 0px; user-select: text; }
    .gslide-desc { color: #666; user-select: text; }
    .gslide-image img { background: white; }
    .gscrollbar-fixer { padding-right: 15px; }
    .gdesc-inner { font-size: 0.75rem; }
    body[data-md-color-scheme="slate"] .gdesc-inner { background: var(--md-default-bg-color);}
    body[data-md-color-scheme="slate"] .gslide-title { color: var(--md-default-fg-color);}
    body[data-md-color-scheme="slate"] .gslide-desc { color: var(--md-default-fg-color);}</style> <script src="../../../assets/javascripts/glightbox.min.js"></script></head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#writing-slurm-batch-jobs" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="Research Computing Documentation" class="md-header__button md-logo" aria-label="Research Computing Documentation" data-md-component="logo">
      
  <img src="../../../images/logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Research Computing Documentation
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Slurm Tutorial
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/uabrc/uabrc.github.io/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="Research Computing Documentation" class="md-nav__button md-logo" aria-label="Research Computing Documentation" data-md-component="logo">
      
  <img src="../../../images/logo.png" alt="logo">

    </a>
    Research Computing Documentation
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/uabrc/uabrc.github.io/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../account_management/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Account Management
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2" id="__nav_2_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Account Management
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../account_management/cheaha_account/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Cheaha Account
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_3" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../account_management/xias/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    External Collaborator Accounts (XIAS)
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2_3" id="__nav_2_3_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_3">
            <span class="md-nav__icon md-icon"></span>
            External Collaborator Accounts (XIAS)
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../account_management/xias/pi_site_management/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    For PIs - (1) Managing Projects & Sites
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../account_management/xias/pi_guest_management/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    For PIs - (2) Managing Guests
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../account_management/xias/guest_instructions/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    For Guests - Account Creation
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../account_management/gitlab_account/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Gitlab Account
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Data Management
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Data Management
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../data_management/storage/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Cheaha Storage
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../data_management/alternate_storage/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Storage Alternatives
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_3" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../data_management/lts/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Long Term Storage
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_3" id="__nav_3_3_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_3">
            <span class="md-nav__icon md-icon"></span>
            Long Term Storage
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_3_2" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../data_management/lts/tutorial/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Tutorial
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_3_2" id="__nav_3_3_2_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_3_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_3_2">
            <span class="md-nav__icon md-icon"></span>
            Tutorial
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../data_management/lts/tutorial/individual_lts_tutorial/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    LTS and s3cmd Workflow
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../data_management/lts/interfaces/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Interfacing with LTS
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../data_management/lts/policies/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Bucket Permissions
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../data_management/lts/lts_cores/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    UAB Core Accounts
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../data_management/lts/lts_faq/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    FAQ
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_4" >
        
          
          <label class="md-nav__link" for="__nav_3_4" id="__nav_3_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Transfer
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_4">
            <span class="md-nav__icon md-icon"></span>
            Transfer
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_4_1" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../data_management/transfer/tutorial/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Tutorial
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_4_1" id="__nav_3_4_1_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_4_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_4_1">
            <span class="md-nav__icon md-icon"></span>
            Tutorial
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../data_management/transfer/tutorial/globus_individual_tutorial/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Globus for Individuals
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../data_management/transfer/tutorial/globus_group_tutorial/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Globus for Groups
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../data_management/transfer/globus/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Globus
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../data_management/transfer/rclone/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    RClone
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../data_management/transfer/filezilla/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    FileZilla
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../data_management/code_storage/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Code Storage
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Workflow Solutions
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Workflow Solutions
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../workflow_solutions/shell/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Using the Shell
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../workflow_solutions/using_anaconda/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Using Anaconda
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../workflow_solutions/using_workflow_managers/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Using Workflow Managers
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../workflow_solutions/git/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Using Git
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../workflow_solutions/r_environments/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    R Projects and Environments
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../workflow_solutions/getting_containers/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Software Containers
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../workflow_solutions/git_collaboration/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Software Collaboration with GitHub and GitLab
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" checked>
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Cheaha Guide
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Cheaha Guide
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../getting_started/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Getting Started
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_2" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../tutorial/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Tutorials
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_5_2" id="__nav_5_2_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_2">
            <span class="md-nav__icon md-icon"></span>
            Tutorials
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/pytorch_tensorflow/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Anaconda Environment Tutorial
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_3" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../open_ondemand/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Cheaha Web Portal
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_5_3" id="__nav_5_3_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_3">
            <span class="md-nav__icon md-icon"></span>
            Cheaha Web Portal
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../open_ondemand/ood_layout/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Using the Web Portal
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../open_ondemand/hpc_desktop/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    HPC Desktop
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../open_ondemand/ood_jupyter/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Jupyter
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../open_ondemand/ood_rstudio/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    RStudio
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../open_ondemand/ood_matlab/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    MATLAB
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../hardware/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Hardware
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_5" >
        
          
          <label class="md-nav__link" for="__nav_5_5" id="__nav_5_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Software
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_5">
            <span class="md-nav__icon md-icon"></span>
            Software
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../software/modules/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Pre-installed Modules
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../software/software/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Self-Installed Software
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_6" checked>
        
          
          <label class="md-nav__link" for="__nav_5_6" id="__nav_5_6_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    SLURM
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_6_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_5_6">
            <span class="md-nav__icon md-icon"></span>
            SLURM
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../introduction/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Introduction
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Slurm Tutorial
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Slurm Tutorial
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
    <a href="#structure-of-a-slurm-batch-job" class="md-nav__link">
      <span class="md-ellipsis">
        Structure of a Slurm Batch Job
      </span>
    </a>

    <!-- Table of contents list -->
    
  </li>
      
        <li class="md-nav__item">
    <a href="#prerequisites" class="md-nav__link">
      <span class="md-ellipsis">
        Prerequisites
      </span>
    </a>

    <!-- Table of contents list -->
    
  </li>
      
        <li class="md-nav__item">
    <a href="#slurm-batch-job-user-guide" class="md-nav__link">
      <span class="md-ellipsis">
        Slurm Batch Job User Guide
      </span>
    </a>

    <!-- Table of contents list -->
    
      <nav class="md-nav" aria-label="Slurm Batch Job User Guide">
        <ul class="md-nav__list">
          
          
            <li class="md-nav__item">
    <a href="#example-1-a-simple-slurm-batch-job" class="md-nav__link">
      <span class="md-ellipsis">
        Example 1: A Simple Slurm Batch Job
      </span>
    </a>

    <!-- Table of contents list -->
    
      <nav class="md-nav" aria-label="Example 1: A Simple Slurm Batch Job">
        <ul class="md-nav__list">
          
          
          
        </ul>
      </nav>
    
  </li>
          
          
          
            <li class="md-nav__item">
    <a href="#example-2-sequential-job" class="md-nav__link">
      <span class="md-ellipsis">
        Example 2: Sequential Job
      </span>
    </a>

    <!-- Table of contents list -->
    
  </li>
          
          
          
            <li class="md-nav__item">
    <a href="#example-3-parallel-jobs" class="md-nav__link">
      <span class="md-ellipsis">
        Example 3: Parallel Jobs
      </span>
    </a>

    <!-- Table of contents list -->
    
  </li>
          
          
          
            <li class="md-nav__item">
    <a href="#example-4-array-job" class="md-nav__link">
      <span class="md-ellipsis">
        Example 4: Array Job
      </span>
    </a>

    <!-- Table of contents list -->
    
  </li>
          
          
          
            <li class="md-nav__item">
    <a href="#example-5-multithreaded-or-multicore-job" class="md-nav__link">
      <span class="md-ellipsis">
        Example 5: Multithreaded or Multicore Job
      </span>
    </a>

    <!-- Table of contents list -->
    
  </li>
          
          
          
            <li class="md-nav__item">
    <a href="#example-6-gpu-job" class="md-nav__link">
      <span class="md-ellipsis">
        Example 6: GPU Job
      </span>
    </a>

    <!-- Table of contents list -->
    
  </li>
          
          
          
            <li class="md-nav__item">
    <a href="#example-7-multinode-job" class="md-nav__link">
      <span class="md-ellipsis">
        Example 7: Multinode Job
      </span>
    </a>

    <!-- Table of contents list -->
    
  </li>
          
          
        </ul>
      </nav>
    
  </li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../submitting_jobs/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Submitting Jobs
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../practical_sbatch/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Practical Batch Array Jobs
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../job_management/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Managing Jobs
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../gpu/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    GPUs
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../job_efficiency/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Job Efficiency
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../uab_cloud/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    UAB Cloud (cloud.rc) Guide
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_6" id="__nav_6_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            UAB Cloud (cloud.rc) Guide
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_2" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../uab_cloud/tutorial/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Tutorial
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_6_2" id="__nav_6_2_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_6_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_2">
            <span class="md-nav__icon md-icon"></span>
            Tutorial
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../uab_cloud/tutorial/networks/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    (1) Networks
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../uab_cloud/tutorial/security/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    (2) Security Policies
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../uab_cloud/tutorial/instances/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    (3) Instances
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../uab_cloud/tutorial/volumes/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    (4) Volumes (optional)
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../uab_cloud/remote_access/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Remote Access
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../uab_cloud/installing_software/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Installing Software
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../uab_cloud/snapshots/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Snapshots and Images
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../uab_cloud/sharing_cloud_environment/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Sharing Cloud Environment
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" >
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    UAB Kubernetes Guide
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            UAB Kubernetes Guide
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../kubernetes/startup/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Startup
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../national_ci/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    National Research Computing Cyberinfrastructure
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_8" id="__nav_8_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8">
            <span class="md-nav__icon md-icon"></span>
            National Research Computing Cyberinfrastructure
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../national_ci/osg/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    The Open Science Grid
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../national_ci/nsf_access/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    NSF Cyberinfrastructure
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../national_ci/nih/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    NIH Cyberinfrastructure
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_9" >
        
          
          <label class="md-nav__link" for="__nav_9" id="__nav_9_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Grants & Contracts
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_9">
            <span class="md-nav__icon md-icon"></span>
            Grants & Contracts
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../grants/facilities/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    RC Facilities Description
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../grants/publications/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Acknowlding Us in Publications
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../grants/opportunities/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Funding Opportunities
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_10" >
        
          
          <label class="md-nav__link" for="__nav_10" id="__nav_10_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Outreach & Training
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_10_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_10">
            <span class="md-nav__icon md-icon"></span>
            Outreach & Training
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../education/case_studies/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Case Studies
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_10_2" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../education/research_computing_days/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Research Computing Days
  </span>
  

            </a>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_10_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_10_2">
            <span class="md-nav__icon md-icon"></span>
            Research Computing Days
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../education/courses/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Offered Courses
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../education/training_resources/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Training Resources
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../policies/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Policies
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../contributing/reporting_errors/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Reporting Documentation Errors
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../contributing/contributor_guide/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Contributing Content
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_14" >
        
          
          <label class="md-nav__link" for="__nav_14" id="__nav_14_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Help
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_14_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_14">
            <span class="md-nav__icon md-icon"></span>
            Help
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../help/support/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Support
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../help/faq/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    FAQ - Frequently Asked Questions
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
    <a href="#structure-of-a-slurm-batch-job" class="md-nav__link">
      <span class="md-ellipsis">
        Structure of a Slurm Batch Job
      </span>
    </a>

    <!-- Table of contents list -->
    
  </li>
      
        <li class="md-nav__item">
    <a href="#prerequisites" class="md-nav__link">
      <span class="md-ellipsis">
        Prerequisites
      </span>
    </a>

    <!-- Table of contents list -->
    
  </li>
      
        <li class="md-nav__item">
    <a href="#slurm-batch-job-user-guide" class="md-nav__link">
      <span class="md-ellipsis">
        Slurm Batch Job User Guide
      </span>
    </a>

    <!-- Table of contents list -->
    
      <nav class="md-nav" aria-label="Slurm Batch Job User Guide">
        <ul class="md-nav__list">
          
          
            <li class="md-nav__item">
    <a href="#example-1-a-simple-slurm-batch-job" class="md-nav__link">
      <span class="md-ellipsis">
        Example 1: A Simple Slurm Batch Job
      </span>
    </a>

    <!-- Table of contents list -->
    
      <nav class="md-nav" aria-label="Example 1: A Simple Slurm Batch Job">
        <ul class="md-nav__list">
          
          
          
        </ul>
      </nav>
    
  </li>
          
          
          
            <li class="md-nav__item">
    <a href="#example-2-sequential-job" class="md-nav__link">
      <span class="md-ellipsis">
        Example 2: Sequential Job
      </span>
    </a>

    <!-- Table of contents list -->
    
  </li>
          
          
          
            <li class="md-nav__item">
    <a href="#example-3-parallel-jobs" class="md-nav__link">
      <span class="md-ellipsis">
        Example 3: Parallel Jobs
      </span>
    </a>

    <!-- Table of contents list -->
    
  </li>
          
          
          
            <li class="md-nav__item">
    <a href="#example-4-array-job" class="md-nav__link">
      <span class="md-ellipsis">
        Example 4: Array Job
      </span>
    </a>

    <!-- Table of contents list -->
    
  </li>
          
          
          
            <li class="md-nav__item">
    <a href="#example-5-multithreaded-or-multicore-job" class="md-nav__link">
      <span class="md-ellipsis">
        Example 5: Multithreaded or Multicore Job
      </span>
    </a>

    <!-- Table of contents list -->
    
  </li>
          
          
          
            <li class="md-nav__item">
    <a href="#example-6-gpu-job" class="md-nav__link">
      <span class="md-ellipsis">
        Example 6: GPU Job
      </span>
    </a>

    <!-- Table of contents list -->
    
  </li>
          
          
          
            <li class="md-nav__item">
    <a href="#example-7-multinode-job" class="md-nav__link">
      <span class="md-ellipsis">
        Example 7: Multinode Job
      </span>
    </a>

    <!-- Table of contents list -->
    
  </li>
          
          
        </ul>
      </nav>
    
  </li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


<h1 id="writing-slurm-batch-jobs">Writing Slurm Batch Jobs<a class="headerlink" href="#writing-slurm-batch-jobs" title="Permanent link">&para;</a></h1>
<p>This Slurm tutorial serves as a hands-on guide for users to create Slurm batch scripts based on their specific software needs and apply them for their respective usecases.  It covers basic examples for beginners and advanced ones, including sequential and parallel jobs, array jobs, multithreaded jobs, GPU utilization jobs, and MPI (Message Passing Interface) jobs. To know which type of batch jobs are suitable for your pipeline/usecase, please refer to the <a href="#slurm-batch-job-user-guide">User Guide</a> section.</p>
<h2 id="structure-of-a-slurm-batch-job">Structure of a Slurm Batch Job<a class="headerlink" href="#structure-of-a-slurm-batch-job" title="Permanent link">&para;</a></h2>
<p>Below is the template for a typical Slurm job submission in the Cheaha high-performance computing (HPC) system. The script begins with <code>#!/bin/bash</code>, indicating it is a bash script. The next step would be to declare Slurm configuration options, specifying the required resources for job execution. This section typically comprises parameters such as CPU count, partition, memory allocation, time limit, etc. Following the configuration, the script may include sections for loading necessary software or libraries required for the job.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="ch">#!/bin/bash</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="c1"># Declaring Slurm configuration options and specifying required resources</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>...
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="c1"># Loading Software/Libraries</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a>...
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="c1"># Running Code</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a>...
</code></pre></div>
<p>The last portion is running the actual code or software. Here, the computational task or program intended for execution is launched using specific commands and processes, which depends on the software used and overall computational workflow. For more detailed specification, refer to <a href="../submitting_jobs/">Slurm job submission</a>. The following sections present practical examples for writing a Slurm batch script to specific use cases, and prerequisites to start with the tutorial.</p>
<h2 id="prerequisites">Prerequisites<a class="headerlink" href="#prerequisites" title="Permanent link">&para;</a></h2>
<p>If you're new to using Unix/Linux commands and bash scripting, we suggest going through the software carpentry lesson, <a href="https://swcarpentry.github.io/shell-novice/">The Unix Shell</a>. Also, we recommend reviewing the <a href="../../hardware/">Cheaha Hardware Information</a> to help guide you in choosing appropriate partition and resources.</p>
<h2 id="slurm-batch-job-user-guide">Slurm Batch Job User Guide<a class="headerlink" href="#slurm-batch-job-user-guide" title="Permanent link">&para;</a></h2>
<p>This user guide provides comprehensive insight into different types of batch jobs, facilitating in identifying the most suitable job type for your specific tasks. With clear explanations and practical examples, you will gain a deeper understanding of sequential, parallel, array, multicore, GPU, and multi-node jobs, assisting to make informed decisions when submitting jobs on the Cheaha system.</p>
<ol>
<li>
<p><a href="#example-1-a-simple-slurm-batch-job">A Simple Slurm Batch Job</a> is ideal for Cheaha users who are just starting with Slurm batch job submission. It uses a simple example to introduce new users to requesting resources with <code>sbatch</code>, printing the <code>hostname</code>, and monitoring batch job submission.</p>
</li>
<li>
<p><a href="#example-2-sequential-job">Sequential Job</a> is used when tasks run one at a time sequentially. Adding more CPUs does not make a sequential job run faster. If you need to run many such sequential jobs simultaneously, you can submit it as an single <a href="#example-4-array-job">array job</a>. For instance, a Python or R script that executes a series of stepssuch as data loading, extraction, analysis, and output reportingwhere each step must be completed before the next can begin.</p>
</li>
<li>
<p><a href="#example-3-parallel-jobs">Parallel Jobs</a> is suitable for executing multiple independent tasks/jobs simultaneously and efficiently distributing them across resources. This approach is particularly beneficial for small-scale tasks that cannot be split into parallel processes within the code itself. For example, consider a Python script that operates on different data set, in such a scenario, you can utilize <code>srun</code> to execute multiple instances of the script concurrently, each operating on a different dataset and on different resources.</p>
</li>
<li>
<p><a href="#example-4-array-job">Array Job</a> is used for submitting and running multiple large number of identical tasks in parallel. They share the same code and execute with similar resource requirements. Instead of submitting multiple <a href="#example-2-sequential-job">sequential job</a>, you can submit a single array job, which helps to manage and schedule a large number of similar tasks efficiently. This improves efficiency, resource utilization, scalability, and ease of debugging. For instance, array jobs can be designed for executing multiple instances of the same task with slight variations in inputs or parameters such as perform <a href="https://home.cc.umanitoba.ca/~psgendb/doc/fastqc.help">FastQC</a> processing on 10 different samples.</p>
</li>
<li>
<p><a href="#example-5-multithreaded-or-multicore-job">Mutlithreaded or Multicore Job</a> is used when software inherently support multithreaded parallelism i.e  run independent tasks simultaneously on multicore processors. For instance, there are numerous software such as <a href="https://www.mathworks.com/help/matlab/ref/parfor.html">MATLAB</a>, <a href="https://help.febio.org/FebioUser/FEBio_um_3-4-Section-2.6.html">FEBio</a>, <a href="https://nmr.cit.nih.gov/xplor-nih/doc/current/helperPrograms/options.html">Xplor-NIH</a> support running multiple tasks at the same time on multicore processors. Users or programmers do not need to modify the code; you can simply enable multithreaded parallelism by configuring the appropriate options.</p>
</li>
<li>
<p><a href="#example-6-gpu-job">GPU Job</a> utilizes the parallel GPUs, which contain numerous cores designed to perform the same mathematical operations simultaneously. GPU job is appropriate for pipelines and software that are designed to run on GPU-based systems and efficiently distribute tasks across cores to process large datasets in parallel. Example includes <a href="https://www.tensorflow.org/guide/gpu">Tensorflow</a>, <a href="../../../education/case_studies/">Parabricks</a>, <a href="https://pytorch.org/tutorials/prototype/ios_gpu_workflow.html#prototype-use-ios-gpu-in-pytorch">PyTorch</a>, etc.</p>
</li>
<li>
<p><a href="#example-7-multinode-job">Multinode Job</a> is for pipeline/software that can be distributed and run across multiple nodes. For example, MPI based applications/tools such as <a href="https://www.quantum-espresso.org/Doc/user_guide/node20.html">Quantum Expresso</a>, <a href="https://usc-rc.github.io/tutorials/amber">Amber</a>, <a href="https://docs.lammps.org/Run_basics.html">LAMMPS</a>, etc.</p>
</li>
</ol>
<h3 id="example-1-a-simple-slurm-batch-job">Example 1: A Simple Slurm Batch Job<a class="headerlink" href="#example-1-a-simple-slurm-batch-job" title="Permanent link">&para;</a></h3>
<p>Let us start with a simple example to print <code>hostname</code> of the node where your job is submitted. You will have to request for the required resources to run your job using Slurm parameters (lines 5-10). To learn more about individual Slurm parameters given in the example, please refer to <a href="../submitting_jobs/#slurm-flags-and-environment-variables">Slurm flag and environment variables</a> and the official <a href="https://slurm.schedmd.com/">Slurm documentation</a>.
o
To test this example, copy the below script in a file named <code>hostname.job</code>. This job executes the <code>hostname</code> command (line 15) on a single node, using one task, one CPU core, 1 gigabyte of memory, with a time limit of 10 minutes. The output and error logs are directed to separate files with names based on their job name and ID (line 11 and 12). For a more detailed understanding of the individual parameters used in this script, please refer to the section on <a href="../submitting_jobs/#a-simple-batch-job">Simple Batch Job</a>. The following script includes comments, marked with <code>###</code>, describing their functions. We will utilize this notation for annotating comments in subsequent examples.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-1-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-1-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-1-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-1-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-1-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-1-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-1-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-1-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-1-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-1-10">10</a></span>
<span class="normal"><a href="#__codelineno-1-11">11</a></span>
<span class="normal"><a href="#__codelineno-1-12">12</a></span>
<span class="normal"><a href="#__codelineno-1-13">13</a></span>
<span class="normal"><a href="#__codelineno-1-14">14</a></span>
<span class="normal"><a href="#__codelineno-1-15">15</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1"></a><span class="ch">#!/bin/bash</span>
<a id="__codelineno-1-2" name="__codelineno-1-2"></a>
<a id="__codelineno-1-3" name="__codelineno-1-3"></a><span class="c1">### Declaring Slurm configuration options and specifying required resources</span>
<a id="__codelineno-1-4" name="__codelineno-1-4"></a><span class="c1">#SBATCH --job-name=hostname     ### Name of the job</span>
<a id="__codelineno-1-5" name="__codelineno-1-5"></a><span class="c1">#SBATCH --nodes=1               ### Number of Nodes</span>
<a id="__codelineno-1-6" name="__codelineno-1-6"></a><span class="c1">#SBATCH --ntasks=1              ### Number of Tasks</span>
<a id="__codelineno-1-7" name="__codelineno-1-7"></a><span class="c1">#SBATCH --cpus-per-task=1       ### Number of Tasks per CPU</span>
<a id="__codelineno-1-8" name="__codelineno-1-8"></a><span class="c1">#SBATCH --mem=1G                ### Memory required, 1 gigabyte</span>
<a id="__codelineno-1-9" name="__codelineno-1-9"></a><span class="c1">#SBATCH --partition=express     ### Cheaha Partition</span>
<a id="__codelineno-1-10" name="__codelineno-1-10"></a><span class="c1">#SBATCH --time=00:10:00         ### Estimated Time of Completion, 10 minutes</span>
<a id="__codelineno-1-11" name="__codelineno-1-11"></a><span class="c1">#SBATCH --output=%x_%j.out      ### Slurm Output file, %x is job name, %j is job id</span>
<a id="__codelineno-1-12" name="__codelineno-1-12"></a><span class="c1">#SBATCH --error=%x_%j.err       ### Slurm Error file, %x is job name, %j is job id</span>
<a id="__codelineno-1-13" name="__codelineno-1-13"></a>
<a id="__codelineno-1-14" name="__codelineno-1-14"></a><span class="c1">### Running the command `hostname`</span>
<a id="__codelineno-1-15" name="__codelineno-1-15"></a>hostname
</code></pre></div></td></tr></table></div>
<h4 id="submitting-and-monitoring-the-job">Submitting and Monitoring the Job<a class="headerlink" href="#submitting-and-monitoring-the-job" title="Permanent link">&para;</a></h4>
<p>Now submit the script <code>hostname.job</code> for execution on Cheaha cluster using <code>sbatch hostname.job</code>. Slurm processes the job script and schedules the job for execution on the cluster. The output you see, "Submitted batch job 26035322," indicates that the job submission was successful, and Slurm has assigned a unique job ID <code>26035322</code>.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="nv">$sbatch</span><span class="w"> </span>hostname.job
<a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a>
<a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a>Submitted<span class="w"> </span>batch<span class="w"> </span>job<span class="w"> </span><span class="m">26035322</span>
</code></pre></div>
<p>After submitting the job, Slurm will create the output and error files with job name <code>hostname</code> and id <code>26035322</code>  as,</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a>$<span class="w"> </span>ls
<a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a>
<a id="__codelineno-3-3" name="__codelineno-3-3" href="#__codelineno-3-3"></a>hostname_26035322.err<span class="w">  </span>hostname_26035322.out<span class="w">  </span>hostname.sh
</code></pre></div>
<p>The submitted job will be added to the Slurm queue and will wait for available resources based on the specified job configuration and the current state of the cluster. You can use <code>squeue -j job_id</code> to monitor the status of your job.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a><span class="nv">$squeue</span><span class="w"> </span>-j<span class="w"> </span><span class="m">26035322</span>
<a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a>
<a id="__codelineno-4-3" name="__codelineno-4-3" href="#__codelineno-4-3"></a>JOBID<span class="w">      </span>PARTITION<span class="w">    </span>NAME<span class="w">        </span>USER<span class="w">    </span>ST<span class="w">       </span>TIME<span class="w">  </span>NODES<span class="w"> </span>NODELIST<span class="o">(</span>REASON<span class="o">)</span>
<a id="__codelineno-4-4" name="__codelineno-4-4" href="#__codelineno-4-4"></a><span class="m">26035322</span><span class="w">   </span>express<span class="w">      </span>hostname<span class="w">    </span>USER<span class="w">    </span>CG<span class="w">       </span><span class="m">0</span>:01<span class="w">      </span><span class="m">1</span><span class="w"> </span>c0156
</code></pre></div>
<p>The above output provides a snapshot of the job's status, resource usage,  indicating that it is currently running on one node (c0156). The term <code>CG</code> refers to completing its execution. For more details refer to <a href="../job_management/">Managing Slurm jobs</a>. If the job is successful, the <code>hostname_26035322.err</code> file will be empty/without error statement. You can print the result using,</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a>$<span class="w"> </span>cat<span class="w"> </span>hostname_26035322.out
<a id="__codelineno-5-2" name="__codelineno-5-2" href="#__codelineno-5-2"></a>c0156
</code></pre></div>
<h3 id="example-2-sequential-job">Example 2: Sequential Job<a class="headerlink" href="#example-2-sequential-job" title="Permanent link">&para;</a></h3>
<p>This example illustrate a Slurm job that runs a Python script involving <a href="https://numpy.org/">NumPy</a> operation. This python script is executed sequentially using the same resource configuration as <a href="./#example-1-a-simple-slurm-batch-job">Example 1</a>. Let us name the below script as <code>numpy.job</code>.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-6-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-6-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-6-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-6-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-6-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-6-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-6-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-6-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-6-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-6-10">10</a></span>
<span class="normal"><a href="#__codelineno-6-11">11</a></span>
<span class="normal"><a href="#__codelineno-6-12">12</a></span>
<span class="normal"><a href="#__codelineno-6-13">13</a></span>
<span class="normal"><a href="#__codelineno-6-14">14</a></span>
<span class="normal"><a href="#__codelineno-6-15">15</a></span>
<span class="normal"><a href="#__codelineno-6-16">16</a></span>
<span class="normal"><a href="#__codelineno-6-17">17</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-6-1" name="__codelineno-6-1"></a><span class="ch">#!/bin/bash</span>
<a id="__codelineno-6-2" name="__codelineno-6-2"></a><span class="c1">#SBATCH --job-name=numpy            ### Name of the job</span>
<a id="__codelineno-6-3" name="__codelineno-6-3"></a><span class="c1">#SBATCH --nodes=1                   ### Number of Nodes</span>
<a id="__codelineno-6-4" name="__codelineno-6-4"></a><span class="c1">#SBATCH --ntasks=1                  ### Number of Tasks</span>
<a id="__codelineno-6-5" name="__codelineno-6-5"></a><span class="c1">#SBATCH --cpus-per-task=1           ### Number of Tasks per CPU</span>
<a id="__codelineno-6-6" name="__codelineno-6-6"></a><span class="c1">#SBATCH --mem=4G                    ### Memory required, 4 gigabyte</span>
<a id="__codelineno-6-7" name="__codelineno-6-7"></a><span class="c1">#SBATCH --partition=express         ### Cheaha Partition</span>
<a id="__codelineno-6-8" name="__codelineno-6-8"></a><span class="c1">#SBATCH --time=01:00:00             ### Estimated Time of Completion, 1 hour</span>
<a id="__codelineno-6-9" name="__codelineno-6-9"></a><span class="c1">#SBATCH --output=%x_%j.out          ### Slurm Output file, %x is job name, %j is job id</span>
<a id="__codelineno-6-10" name="__codelineno-6-10"></a><span class="c1">#SBATCH --error=%x_%j.err           ### Slurm Error file, %x is job name, %j is job id</span>
<a id="__codelineno-6-11" name="__codelineno-6-11"></a>
<a id="__codelineno-6-12" name="__codelineno-6-12"></a><span class="c1">### Loading Anaconda3 module to activate `pytools-env` conda environment</span>
<a id="__codelineno-6-13" name="__codelineno-6-13"></a>module<span class="w"> </span>load<span class="w"> </span>Anaconda3
<a id="__codelineno-6-14" name="__codelineno-6-14"></a>conda<span class="w"> </span>activate<span class="w"> </span>pytools-env
<a id="__codelineno-6-15" name="__codelineno-6-15"></a>
<a id="__codelineno-6-16" name="__codelineno-6-16"></a><span class="c1">### Run the script `python_test.py`</span>
<a id="__codelineno-6-17" name="__codelineno-6-17"></a>python<span class="w"> </span>python_test.py
</code></pre></div></td></tr></table></div>
<p>The batch job requires an input file <code>python_test.py</code> (line 17) for execution. Copy the input file from the <a href="../../../workflow_solutions/getting_containers/#create-your-own-docker-container">Containers page</a>. Place this file in the same folder as the <code>numpy.job</code>. This python script performs numerical integration and data visualization tasks, and it relies on the following packages: numpy, matplotlib, scipy for successful execution. These dependencies can be installed using <a href="../../../workflow_solutions/using_anaconda/">Anaconda</a> within a <code>conda</code> environment named <code>pytools-env</code>. Prior to running the script, load the <code>Anaconda3</code> module and activate the <code>pytools-env</code> environment (line 13 and 14).  Once job is successfully completed, check the slurm output file for results. Additionally, a plot named <code>testing.png</code> will be generated.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a>$<span class="w"> </span>ls
<a id="__codelineno-7-2" name="__codelineno-7-2" href="#__codelineno-7-2"></a>
<a id="__codelineno-7-3" name="__codelineno-7-3" href="#__codelineno-7-3"></a>numpy_26127143.err<span class="w">  </span>numpy_26127143.out<span class="w">  </span>numpy.job<span class="w">  </span>python_test.py<span class="w">  </span>testing.png
</code></pre></div>
<div class="highlight"><pre><span></span><code><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a><span class="nv">$cat</span><span class="w"> </span>numpy_26127143.out
<a id="__codelineno-8-2" name="__codelineno-8-2" href="#__codelineno-8-2"></a>
<a id="__codelineno-8-3" name="__codelineno-8-3" href="#__codelineno-8-3"></a><span class="o">[</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">10</span><span class="w"> </span><span class="m">20</span><span class="w"> </span><span class="m">30</span><span class="w"> </span><span class="m">40</span><span class="o">]</span>
<a id="__codelineno-8-4" name="__codelineno-8-4" href="#__codelineno-8-4"></a><span class="o">[</span>-5.<span class="w">  </span>-4.5<span class="w"> </span>-4.<span class="w">  </span>-3.5<span class="w"> </span>-3.<span class="w">  </span>-2.5<span class="w"> </span>-2.<span class="w">  </span>-1.5<span class="w"> </span>-1.<span class="w">  </span>-0.5<span class="w">  </span><span class="m">0</span>.<span class="w">   </span><span class="m">0</span>.5<span class="w">  </span><span class="m">1</span>.<span class="w">   </span><span class="m">1</span>.5
<a id="__codelineno-8-5" name="__codelineno-8-5" href="#__codelineno-8-5"></a><span class="w">  </span><span class="m">1</span>.<span class="w">   </span><span class="m">2</span>.5<span class="w">  </span><span class="m">3</span>.<span class="w">   </span><span class="m">3</span>.5<span class="w">  </span><span class="m">4</span>.<span class="w">   </span><span class="m">4</span>.5<span class="o">]</span>
<a id="__codelineno-8-6" name="__codelineno-8-6" href="#__codelineno-8-6"></a><span class="o">[</span><span class="w"> </span><span class="m">0</span>.<span class="w">   </span><span class="m">0</span>.5<span class="w">  </span><span class="m">1</span>.<span class="w">   </span><span class="m">1</span>.5<span class="w">  </span><span class="m">2</span>.<span class="w">   </span><span class="m">2</span>.5<span class="w">  </span><span class="m">3</span>.<span class="w">   </span><span class="m">3</span>.5<span class="w">  </span><span class="m">4</span>.<span class="w">   </span><span class="m">4</span>.5<span class="w">  </span><span class="m">5</span>.<span class="w">   </span><span class="m">5</span>.5<span class="w">  </span><span class="m">6</span>.<span class="w">   </span><span class="m">6</span>.5
<a id="__codelineno-8-7" name="__codelineno-8-7" href="#__codelineno-8-7"></a><span class="w">  </span><span class="m">1</span>.<span class="w">   </span><span class="m">7</span>.5<span class="w">  </span><span class="m">8</span>.<span class="w">   </span><span class="m">8</span>.5<span class="w">  </span><span class="m">9</span>.<span class="w">   </span><span class="m">9</span>.5<span class="w"> </span><span class="m">10</span>.<span class="w">  </span><span class="m">10</span>.5<span class="w"> </span><span class="m">11</span>.<span class="w">  </span><span class="m">11</span>.5<span class="w"> </span><span class="m">12</span>.<span class="w">  </span><span class="m">12</span>.5<span class="w"> </span><span class="m">13</span>.<span class="w">  </span><span class="m">13</span>.5
<a id="__codelineno-8-8" name="__codelineno-8-8" href="#__codelineno-8-8"></a><span class="w"> </span><span class="m">1</span>.<span class="w">   </span><span class="m">14</span>.5<span class="w"> </span><span class="m">15</span>.<span class="w">  </span><span class="m">15</span>.5<span class="w"> </span><span class="m">16</span>.<span class="w">  </span><span class="m">16</span>.5<span class="w"> </span><span class="m">17</span>.<span class="w">  </span><span class="m">17</span>.5<span class="w"> </span><span class="m">18</span>.<span class="w">  </span><span class="m">18</span>.5<span class="w"> </span><span class="m">19</span>.<span class="w">  </span><span class="m">19</span>.5<span class="w"> </span><span class="m">20</span>.<span class="w"> </span><span class="o">]</span>
<a id="__codelineno-8-9" name="__codelineno-8-9" href="#__codelineno-8-9"></a><span class="o">(</span><span class="m">2</span>.0,<span class="w"> </span><span class="m">2</span>.220446049250313e-14<span class="o">)</span>
</code></pre></div>
<p>You can review detailed information about finished jobs using <code>sacct</code> command for a specific job id as shown below. For instance, this job was allocated with one CPU and has been successfully completed. The lines with ".ba+" and ".ex+" refer to batch step and external step within a job, but we will ignore them for simplicity in this and future examples. The exit code <code>0:0</code> signifies a normal exit with no errors.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a>$<span class="w"> </span>sacct<span class="w"> </span>-j<span class="w"> </span><span class="m">26127143</span>
<a id="__codelineno-9-2" name="__codelineno-9-2" href="#__codelineno-9-2"></a>
<a id="__codelineno-9-3" name="__codelineno-9-3" href="#__codelineno-9-3"></a><span class="w">       </span>JobID<span class="w">    </span>JobName<span class="w">  </span>Partition<span class="w">    </span>Account<span class="w">  </span>AllocCPUS<span class="w">      </span>State<span class="w"> </span>ExitCode
<a id="__codelineno-9-4" name="__codelineno-9-4" href="#__codelineno-9-4"></a>------------<span class="w"> </span>----------<span class="w"> </span>----------<span class="w"> </span>----------<span class="w"> </span>----------<span class="w"> </span>----------<span class="w"> </span>--------
<a id="__codelineno-9-5" name="__codelineno-9-5" href="#__codelineno-9-5"></a><span class="m">26127143</span><span class="w">          </span>numpy<span class="w">    </span>express<span class="w">      </span>USER<span class="w">          </span><span class="m">1</span><span class="w">  </span>COMPLETED<span class="w">      </span><span class="m">0</span>:0
<a id="__codelineno-9-6" name="__codelineno-9-6" href="#__codelineno-9-6"></a><span class="m">26127143</span>.ba+<span class="w">      </span>batch<span class="w">                 </span>USER<span class="w">          </span><span class="m">1</span><span class="w">  </span>COMPLETED<span class="w">      </span><span class="m">0</span>:0
<a id="__codelineno-9-7" name="__codelineno-9-7" href="#__codelineno-9-7"></a><span class="m">26127143</span>.ex+<span class="w">     </span>extern<span class="w">                 </span>USER<span class="w">          </span><span class="m">1</span><span class="w">  </span>COMPLETED<span class="w">      </span><span class="m">0</span>:0
</code></pre></div>
<h3 id="example-3-parallel-jobs">Example 3: Parallel Jobs<a class="headerlink" href="#example-3-parallel-jobs" title="Permanent link">&para;</a></h3>
<p>Multiple jobs or tasks can be executed simultaneously using <code>srun</code> within a single batch script. In this example, the same executable <code>python_script_new.py</code> is run in parallel with distinct inputs (line 17-19). The <code>&amp;</code> symbol at the end of each line run these commands in background. The <code>wait</code> command (line 20) performs synchronization and ensures that all background processes and parallel tasks are completed before finishing. In Line 4, three tasks are requested as there are three executables to be run in parallel. The overall job script is allocated with three CPUs, and in lines(17-19), each <code>srun</code> script utilizes 1 CPU to perform their respective task. Copy the batch script into a file named <code>multijob.job</code>. Use the same <code>conda</code> environment <code>pytools-env</code> shown in <a href="./#example-2-sequential-job">example2</a>.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-10-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-10-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-10-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-10-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-10-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-10-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-10-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-10-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-10-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-10-10">10</a></span>
<span class="normal"><a href="#__codelineno-10-11">11</a></span>
<span class="normal"><a href="#__codelineno-10-12">12</a></span>
<span class="normal"><a href="#__codelineno-10-13">13</a></span>
<span class="normal"><a href="#__codelineno-10-14">14</a></span>
<span class="normal"><a href="#__codelineno-10-15">15</a></span>
<span class="normal"><a href="#__codelineno-10-16">16</a></span>
<span class="normal"><a href="#__codelineno-10-17">17</a></span>
<span class="normal"><a href="#__codelineno-10-18">18</a></span>
<span class="normal"><a href="#__codelineno-10-19">19</a></span>
<span class="normal"><a href="#__codelineno-10-20">20</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-10-1" name="__codelineno-10-1"></a><span class="ch">#!/bin/bash</span>
<a id="__codelineno-10-2" name="__codelineno-10-2"></a><span class="c1">#SBATCH --job-name=multijob             ### Name of the job</span>
<a id="__codelineno-10-3" name="__codelineno-10-3"></a><span class="c1">#SBATCH --nodes=1                       ### Number of Nodes</span>
<a id="__codelineno-10-4" name="__codelineno-10-4"></a><span class="c1">#SBATCH --ntasks=3                      ### Number of Tasks</span>
<a id="__codelineno-10-5" name="__codelineno-10-5"></a><span class="c1">#SBATCH --cpus-per-task=1               ### Number of Tasks per CPU</span>
<a id="__codelineno-10-6" name="__codelineno-10-6"></a><span class="c1">#SBATCH --mem=4G                        ### Memory required, 4 gigabyte</span>
<a id="__codelineno-10-7" name="__codelineno-10-7"></a><span class="c1">#SBATCH --partition=express             ### Cheaha Partition</span>
<a id="__codelineno-10-8" name="__codelineno-10-8"></a><span class="c1">#SBATCH --time=01:00:00                 ### Estimated Time of Completion, 1 hour</span>
<a id="__codelineno-10-9" name="__codelineno-10-9"></a><span class="c1">#SBATCH --output=%x_%j.out              ### Slurm Output file, %x is job name, %j is job id</span>
<a id="__codelineno-10-10" name="__codelineno-10-10"></a><span class="c1">#SBATCH --error=%x_%j.err               ### Slurm Error file, %x is job name, %j is job id</span>
<a id="__codelineno-10-11" name="__codelineno-10-11"></a>
<a id="__codelineno-10-12" name="__codelineno-10-12"></a><span class="c1">### Loading Anaconda3 module to activate `pytools-env` conda environment</span>
<a id="__codelineno-10-13" name="__codelineno-10-13"></a>module<span class="w"> </span>load<span class="w"> </span>Anaconda3
<a id="__codelineno-10-14" name="__codelineno-10-14"></a>conda<span class="w"> </span>activate<span class="w"> </span>pytools-env
<a id="__codelineno-10-15" name="__codelineno-10-15"></a>
<a id="__codelineno-10-16" name="__codelineno-10-16"></a><span class="c1">### Runs the script `python_test.py` in parallel with distinct inputs and ensures synchronization</span>
<a id="__codelineno-10-17" name="__codelineno-10-17"></a>srun<span class="w"> </span>--nodes<span class="o">=</span><span class="m">1</span><span class="w"> </span>--ntasks<span class="o">=</span><span class="m">1</span><span class="w"> </span>python<span class="w"> </span>python_script_new.py<span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">100000</span><span class="w"> </span><span class="p">&amp;</span>
<a id="__codelineno-10-18" name="__codelineno-10-18"></a>srun<span class="w"> </span>--nodes<span class="o">=</span><span class="m">1</span><span class="w"> </span>--ntasks<span class="o">=</span><span class="m">1</span><span class="w"> </span>python<span class="w"> </span>python_script_new.py<span class="w"> </span><span class="m">100001</span><span class="w"> </span><span class="m">200000</span><span class="w"> </span><span class="p">&amp;</span>
<a id="__codelineno-10-19" name="__codelineno-10-19"></a>srun<span class="w"> </span>--nodes<span class="o">=</span><span class="m">1</span><span class="w"> </span>--ntasks<span class="o">=</span><span class="m">1</span><span class="w"> </span>python<span class="w"> </span>python_script_new.py<span class="w"> </span><span class="m">200001</span><span class="w"> </span><span class="m">300000</span><span class="w"> </span><span class="p">&amp;</span>
<a id="__codelineno-10-20" name="__codelineno-10-20"></a><span class="nb">wait</span>
</code></pre></div></td></tr></table></div>
<p>Copy the following python script and call it as <code>python_script_new.py</code>. The input file takes two command-line arguments i.e. the <code>start</code> and <code>end</code> values. The script uses these values to creates an array and compute the sum of its elements using numpy. The above batch script runs three parallel instances of this Python script with different inputs.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-11-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-11-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-11-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-11-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-11-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-11-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-11-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-11-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-11-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-11-10">10</a></span>
<span class="normal"><a href="#__codelineno-11-11">11</a></span>
<span class="normal"><a href="#__codelineno-11-12">12</a></span>
<span class="normal"><a href="#__codelineno-11-13">13</a></span>
<span class="normal"><a href="#__codelineno-11-14">14</a></span>
<span class="normal"><a href="#__codelineno-11-15">15</a></span>
<span class="normal"><a href="#__codelineno-11-16">16</a></span>
<span class="normal"><a href="#__codelineno-11-17">17</a></span>
<span class="normal"><a href="#__codelineno-11-18">18</a></span>
<span class="normal"><a href="#__codelineno-11-19">19</a></span>
<span class="normal"><a href="#__codelineno-11-20">20</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-11-1" name="__codelineno-11-1"></a>import<span class="w"> </span>sys
<a id="__codelineno-11-2" name="__codelineno-11-2"></a>import<span class="w"> </span>numpy<span class="w"> </span>as<span class="w"> </span>np
<a id="__codelineno-11-3" name="__codelineno-11-3"></a>
<a id="__codelineno-11-4" name="__codelineno-11-4"></a><span class="c1">### Verify if correct number of command-line arguments is provided</span>
<a id="__codelineno-11-5" name="__codelineno-11-5"></a><span class="k">if</span><span class="w"> </span>len<span class="o">(</span>sys.argv<span class="o">)</span><span class="w"> </span>!<span class="o">=</span><span class="w"> </span><span class="m">3</span>:
<a id="__codelineno-11-6" name="__codelineno-11-6"></a><span class="w">  </span>print<span class="o">(</span><span class="s2">&quot;Usage: python python_script_new.py &lt;start&gt; &lt;end&gt;&quot;</span><span class="o">)</span>
<a id="__codelineno-11-7" name="__codelineno-11-7"></a><span class="w">  </span>sys.exit<span class="o">(</span><span class="m">1</span><span class="o">)</span>
<a id="__codelineno-11-8" name="__codelineno-11-8"></a>
<a id="__codelineno-11-9" name="__codelineno-11-9"></a><span class="c1">### Passing start and end values from command-line arguments</span>
<a id="__codelineno-11-10" name="__codelineno-11-10"></a><span class="nv">start</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>int<span class="o">(</span>sys.argv<span class="o">[</span><span class="m">1</span><span class="o">])</span>
<a id="__codelineno-11-11" name="__codelineno-11-11"></a><span class="nv">end</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>int<span class="o">(</span>sys.argv<span class="o">[</span><span class="m">2</span><span class="o">])</span>
<a id="__codelineno-11-12" name="__codelineno-11-12"></a>
<a id="__codelineno-11-13" name="__codelineno-11-13"></a><span class="c1">### Create an array from start to end using numpy</span>
<a id="__codelineno-11-14" name="__codelineno-11-14"></a><span class="nv">input_array</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>np.arange<span class="o">(</span>start,<span class="w"> </span>end<span class="o">)</span>
<a id="__codelineno-11-15" name="__codelineno-11-15"></a>
<a id="__codelineno-11-16" name="__codelineno-11-16"></a><span class="c1">### Perform addition on the array elements using numpy&#39;s sum function</span>
<a id="__codelineno-11-17" name="__codelineno-11-17"></a><span class="nv">sum_result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>np.sum<span class="o">(</span>input_array<span class="o">)</span>
<a id="__codelineno-11-18" name="__codelineno-11-18"></a>
<a id="__codelineno-11-19" name="__codelineno-11-19"></a><span class="c1">### Print Input Range and Sum</span>
<a id="__codelineno-11-20" name="__codelineno-11-20"></a>print<span class="o">(</span><span class="s2">&quot;Input Range: {} to {}, Sum: {}&quot;</span>.format<span class="o">(</span>start,<span class="w"> </span>end,<span class="w"> </span>sum_result<span class="o">))</span>
</code></pre></div></td></tr></table></div>
<p>The below output shows that each line corresponds to the output of one parallel execution of python script with specific input ranges. Note that the results are in out of order. This is because each <code>srun</code> script runs independently, and their completion times may vary based on factors such as system load, resource availability, and the nature of their computations. If the results must be in order to be correct, you will need to modify your script to explicitly collect and organize them. One possible approach can be found in the section <a href="../submitting_jobs/#srun-for-running-parallel-jobs">srun for running parallel jobs</a> (refer to example 2).</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-12-1" name="__codelineno-12-1" href="#__codelineno-12-1"></a><span class="nv">$cat</span><span class="w"> </span>multijob_27099591.out
<a id="__codelineno-12-2" name="__codelineno-12-2" href="#__codelineno-12-2"></a>
<a id="__codelineno-12-3" name="__codelineno-12-3" href="#__codelineno-12-3"></a>Input<span class="w"> </span>Range:<span class="w"> </span><span class="m">1</span><span class="w"> </span>to<span class="w"> </span><span class="m">100000</span>,<span class="w"> </span>Sum:<span class="w"> </span><span class="m">4999950000</span>
<a id="__codelineno-12-4" name="__codelineno-12-4" href="#__codelineno-12-4"></a>Input<span class="w"> </span>Range:<span class="w"> </span><span class="m">200001</span><span class="w"> </span>to<span class="w"> </span><span class="m">300000</span>,<span class="w"> </span>Sum:<span class="w"> </span><span class="m">24999750000</span>
<a id="__codelineno-12-5" name="__codelineno-12-5" href="#__codelineno-12-5"></a>Input<span class="w"> </span>Range:<span class="w"> </span><span class="m">100001</span><span class="w"> </span>to<span class="w"> </span><span class="m">200000</span>,<span class="w"> </span>Sum:<span class="w"> </span><span class="m">14999850000</span>
</code></pre></div>
<p>The <code>sacct</code> report indicates that three CPUs have been allocated. The python script executes with unique task IDs 27099591.0,27099591.1,27099591.2.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-13-1" name="__codelineno-13-1" href="#__codelineno-13-1"></a>$<span class="w"> </span>sacct<span class="w"> </span>-j<span class="w"> </span><span class="m">27099591</span>
<a id="__codelineno-13-2" name="__codelineno-13-2" href="#__codelineno-13-2"></a>
<a id="__codelineno-13-3" name="__codelineno-13-3" href="#__codelineno-13-3"></a><span class="w">       </span>JobID<span class="w">    </span>JobName<span class="w">  </span>Partition<span class="w">    </span>Account<span class="w">  </span>AllocCPUS<span class="w">      </span>State<span class="w"> </span>ExitCode
<a id="__codelineno-13-4" name="__codelineno-13-4" href="#__codelineno-13-4"></a>------------<span class="w"> </span>----------<span class="w"> </span>----------<span class="w"> </span>----------<span class="w"> </span>----------<span class="w"> </span>----------<span class="w"> </span>--------
<a id="__codelineno-13-5" name="__codelineno-13-5" href="#__codelineno-13-5"></a><span class="m">27099591</span><span class="w">       </span>multijob<span class="w">    </span>express<span class="w">      </span>USER<span class="w">          </span><span class="m">3</span><span class="w">  </span>COMPLETED<span class="w">      </span><span class="m">0</span>:0
<a id="__codelineno-13-6" name="__codelineno-13-6" href="#__codelineno-13-6"></a><span class="m">27099591</span>.ba+<span class="w">      </span>batch<span class="w">                 </span>USER<span class="w">          </span><span class="m">3</span><span class="w">  </span>COMPLETED<span class="w">      </span><span class="m">0</span>:0
<a id="__codelineno-13-7" name="__codelineno-13-7" href="#__codelineno-13-7"></a><span class="m">27099591</span>.ex+<span class="w">     </span>extern<span class="w">                 </span>USER<span class="w">          </span><span class="m">3</span><span class="w">  </span>COMPLETED<span class="w">      </span><span class="m">0</span>:0
<a id="__codelineno-13-8" name="__codelineno-13-8" href="#__codelineno-13-8"></a><span class="m">27099591</span>.0<span class="w">       </span>python<span class="w">                 </span>USER<span class="w">          </span><span class="m">1</span><span class="w">  </span>COMPLETED<span class="w">      </span><span class="m">0</span>:0
<a id="__codelineno-13-9" name="__codelineno-13-9" href="#__codelineno-13-9"></a><span class="m">27099591</span>.1<span class="w">       </span>python<span class="w">                 </span>USER<span class="w">          </span><span class="m">1</span><span class="w">  </span>COMPLETED<span class="w">      </span><span class="m">0</span>:0
<a id="__codelineno-13-10" name="__codelineno-13-10" href="#__codelineno-13-10"></a><span class="m">27099591</span>.2<span class="w">       </span>python<span class="w">                 </span>USER<span class="w">          </span><span class="m">1</span><span class="w">  </span>COMPLETED<span class="w">      </span><span class="m">0</span>:0
</code></pre></div>
<h3 id="example-4-array-job">Example 4: Array Job<a class="headerlink" href="#example-4-array-job" title="Permanent link">&para;</a></h3>
<p>Array jobs are more effective when you have a larger number of similar tasks to be executed simultaneously with varied input data, unlike <code>srun</code> parallel jobs which are suitable for running a smaller number of tasks concurrently (e.g. less than 5). Array jobs are easier to manage and monitor multiple tasks through unique identifiers.</p>
<p>The following Slurm script is an example of how you might convert the previous <code>multijob</code> script to an array job. To start, copy the below script to a file named, <code>slurm_array.job</code>. The script requires the input file <code>python_script_new.py</code> and the <code>conda</code> environment <code>pytools-env</code>, similar to those used in <a href="./#example-2-sequential-job">example2</a> and <a href="./#example-3-parallel-jobs">example 3</a>. Line 11 specifies the script as an array job, treating each task within the array as an independent job. For each task, lines 18-19 calculates the input range. <code>SLURM_ARRAY_TASK_ID</code> identifies the task executed using indexes, and is automatically set for array jobs. The python script (line 22) runs individual array task concurrently on respective input range. The command <code>awk</code> is used to prepend each output line with the unique task identifier and then append the results to the file, <code>output_all_tasks.txt</code>. For more details on on parameters of array jobs, please refer to <a href="../submitting_jobs/#batch-array-jobs-with-known-indices">Batch Array Jobs</a> and <a href="../practical_sbatch/">Practical Batch Array Jobs</a>.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-14-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-14-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-14-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-14-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-14-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-14-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-14-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-14-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-14-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-14-10">10</a></span>
<span class="normal"><a href="#__codelineno-14-11">11</a></span>
<span class="normal"><a href="#__codelineno-14-12">12</a></span>
<span class="normal"><a href="#__codelineno-14-13">13</a></span>
<span class="normal"><a href="#__codelineno-14-14">14</a></span>
<span class="normal"><a href="#__codelineno-14-15">15</a></span>
<span class="normal"><a href="#__codelineno-14-16">16</a></span>
<span class="normal"><a href="#__codelineno-14-17">17</a></span>
<span class="normal"><a href="#__codelineno-14-18">18</a></span>
<span class="normal"><a href="#__codelineno-14-19">19</a></span>
<span class="normal"><a href="#__codelineno-14-20">20</a></span>
<span class="normal"><a href="#__codelineno-14-21">21</a></span>
<span class="normal"><a href="#__codelineno-14-22">22</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-14-1" name="__codelineno-14-1"></a><span class="ch">#!/bin/bash</span>
<a id="__codelineno-14-2" name="__codelineno-14-2"></a><span class="c1">#SBATCH --job-name=slurm_array       ### Name of the job</span>
<a id="__codelineno-14-3" name="__codelineno-14-3"></a><span class="c1">#SBATCH --nodes=1                    ### Number of Nodes</span>
<a id="__codelineno-14-4" name="__codelineno-14-4"></a><span class="c1">#SBATCH --ntasks=1                   ### Number of Tasks</span>
<a id="__codelineno-14-5" name="__codelineno-14-5"></a><span class="c1">#SBATCH --cpus-per-task=1            ### Number of Tasks per CPU</span>
<a id="__codelineno-14-6" name="__codelineno-14-6"></a><span class="c1">#SBATCH --mem=4G                     ### Memory required, 4 gigabyte</span>
<a id="__codelineno-14-7" name="__codelineno-14-7"></a><span class="c1">#SBATCH --partition=express          ### Cheaha Partition</span>
<a id="__codelineno-14-8" name="__codelineno-14-8"></a><span class="c1">#SBATCH --time=01:00:00              ### Estimated Time of Completion, 1 hour</span>
<a id="__codelineno-14-9" name="__codelineno-14-9"></a><span class="c1">#SBATCH --output=%x_%A_%a.out        ### Slurm Output file, %x is job name, %A is array job id, %a is array job index</span>
<a id="__codelineno-14-10" name="__codelineno-14-10"></a><span class="c1">#SBATCH --error=%x_%A_%a.err         ### Slurm Error file, %x is job name, %A is array job id, %a is array job index</span>
<a id="__codelineno-14-11" name="__codelineno-14-11"></a><span class="c1">#SBATCH --array=1-3                  ### Number of Slurm array tasks, 3 tasks</span>
<a id="__codelineno-14-12" name="__codelineno-14-12"></a>
<a id="__codelineno-14-13" name="__codelineno-14-13"></a><span class="c1">### Loading Anaconda3 module to activate `pytools-env` conda environment</span>
<a id="__codelineno-14-14" name="__codelineno-14-14"></a>module<span class="w"> </span>load<span class="w"> </span>Anaconda3
<a id="__codelineno-14-15" name="__codelineno-14-15"></a>conda<span class="w"> </span>activate<span class="w"> </span>pytools-env
<a id="__codelineno-14-16" name="__codelineno-14-16"></a>
<a id="__codelineno-14-17" name="__codelineno-14-17"></a><span class="c1">### Calculate the input range for each task</span>
<a id="__codelineno-14-18" name="__codelineno-14-18"></a><span class="nv">start</span><span class="o">=</span><span class="k">$((</span><span class="o">(</span><span class="nv">$SLURM_ARRAY_TASK_ID</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="m">1</span><span class="o">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="m">100000</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="m">1</span><span class="k">))</span>
<a id="__codelineno-14-19" name="__codelineno-14-19"></a><span class="nv">end</span><span class="o">=</span><span class="k">$((</span><span class="nv">$SLURM_ARRAY_TASK_ID</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="m">100000</span><span class="k">))</span>
<a id="__codelineno-14-20" name="__codelineno-14-20"></a>
<a id="__codelineno-14-21" name="__codelineno-14-21"></a><span class="c1">### Run the python script with input arguments and append the results to a .txt file for each task</span>
<a id="__codelineno-14-22" name="__codelineno-14-22"></a>python<span class="w"> </span>python_script_new.py<span class="w"> </span><span class="nv">$start</span><span class="w"> </span><span class="nv">$end</span><span class="w"> </span><span class="m">2</span>&gt;<span class="p">&amp;</span><span class="m">1</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>awk<span class="w"> </span>-v<span class="w"> </span><span class="nv">task_id</span><span class="o">=</span><span class="nv">$SLURM_ARRAY_TASK_ID</span><span class="w"> </span><span class="s1">&#39;{print &quot;array task &quot; task_id, $0}&#39;</span><span class="w"> </span>&gt;&gt;<span class="w"> </span>output_all_tasks.txt
</code></pre></div></td></tr></table></div>
<p>The output shows the sum of different input range computed by individual task, making it easy to track using a task identifier, such as array task 1/2/3.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-15-1" name="__codelineno-15-1" href="#__codelineno-15-1"></a>$<span class="w"> </span>cat<span class="w"> </span>output_all_tasks.txt
<a id="__codelineno-15-2" name="__codelineno-15-2" href="#__codelineno-15-2"></a>
<a id="__codelineno-15-3" name="__codelineno-15-3" href="#__codelineno-15-3"></a>array<span class="w"> </span>task<span class="w"> </span><span class="m">2</span><span class="w"> </span>Input<span class="w"> </span>Range:<span class="w"> </span><span class="m">100001</span><span class="w"> </span>to<span class="w"> </span><span class="m">200000</span>,<span class="w"> </span>Sum:<span class="w"> </span><span class="m">14999850000</span>
<a id="__codelineno-15-4" name="__codelineno-15-4" href="#__codelineno-15-4"></a>array<span class="w"> </span>task<span class="w"> </span><span class="m">3</span><span class="w"> </span>Input<span class="w"> </span>Range:<span class="w"> </span><span class="m">200001</span><span class="w"> </span>to<span class="w"> </span><span class="m">300000</span>,<span class="w"> </span>Sum:<span class="w"> </span><span class="m">24999750000</span>
<a id="__codelineno-15-5" name="__codelineno-15-5" href="#__codelineno-15-5"></a>array<span class="w"> </span>task<span class="w"> </span><span class="m">1</span><span class="w"> </span>Input<span class="w"> </span>Range:<span class="w"> </span><span class="m">1</span><span class="w"> </span>to<span class="w"> </span><span class="m">100000</span>,<span class="w"> </span>Sum:<span class="w"> </span><span class="m">4999950000</span>
</code></pre></div>
<p>The <code>sacct</code> report indicates that the job <code>27101430</code> consists of three individual tasks, namely <code>27101430_1</code>, <code>27101430_2</code>, and <code>27101430_3</code>. Each task has been allocated one CPU resource.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-16-1" name="__codelineno-16-1" href="#__codelineno-16-1"></a>$<span class="w"> </span>sacct<span class="w"> </span>-j<span class="w"> </span><span class="m">27101430</span>
<a id="__codelineno-16-2" name="__codelineno-16-2" href="#__codelineno-16-2"></a>
<a id="__codelineno-16-3" name="__codelineno-16-3" href="#__codelineno-16-3"></a><span class="w">       </span>JobID<span class="w">    </span>JobName<span class="w">  </span>Partition<span class="w">    </span>Account<span class="w">  </span>AllocCPUS<span class="w">      </span>State<span class="w"> </span>ExitCode
<a id="__codelineno-16-4" name="__codelineno-16-4" href="#__codelineno-16-4"></a>------------<span class="w"> </span>----------<span class="w"> </span>----------<span class="w"> </span>----------<span class="w"> </span>----------<span class="w"> </span>----------<span class="w"> </span>--------
<a id="__codelineno-16-5" name="__codelineno-16-5" href="#__codelineno-16-5"></a>27101430_3<span class="w">   </span>slurm_arr+<span class="w">    </span>express<span class="w">      </span>USER<span class="w">          </span><span class="m">1</span><span class="w">  </span>COMPLETED<span class="w">      </span><span class="m">0</span>:0
<a id="__codelineno-16-6" name="__codelineno-16-6" href="#__codelineno-16-6"></a>27101430_3.+<span class="w">      </span>batch<span class="w">                 </span>USER<span class="w">          </span><span class="m">1</span><span class="w">  </span>COMPLETED<span class="w">      </span><span class="m">0</span>:0
<a id="__codelineno-16-7" name="__codelineno-16-7" href="#__codelineno-16-7"></a>27101430_3.+<span class="w">     </span>extern<span class="w">                 </span>USER<span class="w">          </span><span class="m">1</span><span class="w">  </span>COMPLETED<span class="w">      </span><span class="m">0</span>:0
<a id="__codelineno-16-8" name="__codelineno-16-8" href="#__codelineno-16-8"></a>27101430_1<span class="w">   </span>slurm_arr+<span class="w">    </span>express<span class="w">      </span>USER<span class="w">          </span><span class="m">1</span><span class="w">  </span>COMPLETED<span class="w">      </span><span class="m">0</span>:0
<a id="__codelineno-16-9" name="__codelineno-16-9" href="#__codelineno-16-9"></a>27101430_1.+<span class="w">      </span>batch<span class="w">                 </span>USER<span class="w">          </span><span class="m">1</span><span class="w">  </span>COMPLETED<span class="w">      </span><span class="m">0</span>:0
<a id="__codelineno-16-10" name="__codelineno-16-10" href="#__codelineno-16-10"></a>27101430_1.+<span class="w">     </span>extern<span class="w">                 </span>USER<span class="w">          </span><span class="m">1</span><span class="w">  </span>COMPLETED<span class="w">      </span><span class="m">0</span>:0
<a id="__codelineno-16-11" name="__codelineno-16-11" href="#__codelineno-16-11"></a>27101430_2<span class="w">   </span>slurm_arr+<span class="w">    </span>express<span class="w">      </span>USER<span class="w">          </span><span class="m">1</span><span class="w">  </span>COMPLETED<span class="w">      </span><span class="m">0</span>:0
<a id="__codelineno-16-12" name="__codelineno-16-12" href="#__codelineno-16-12"></a>27101430_2.+<span class="w">      </span>batch<span class="w">                 </span>USER<span class="w">          </span><span class="m">1</span><span class="w">  </span>COMPLETED<span class="w">      </span><span class="m">0</span>:0
<a id="__codelineno-16-13" name="__codelineno-16-13" href="#__codelineno-16-13"></a>27101430_2.+<span class="w">     </span>extern<span class="w">                 </span>USER<span class="w">          </span><span class="m">1</span><span class="w">  </span>COMPLETED<span class="w">      </span><span class="m">0</span>:0
</code></pre></div>
<h3 id="example-5-multithreaded-or-multicore-job">Example 5: Multithreaded or Multicore Job<a class="headerlink" href="#example-5-multithreaded-or-multicore-job" title="Permanent link">&para;</a></h3>
<p>This Slurm script illustrates execution of a MATLAB script in a multithread/multicore environemnt. Save the script as <code>multithread.job</code>. The <code>%</code> symbol in this script denotes comments within MATLAB code. Line 16 runs the MATLAB script <code>parfor_sum_array</code>, with an input array size <code>100</code> passed as argument, using 4 CPU cores (as specified in Line 5).</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-17-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-17-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-17-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-17-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-17-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-17-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-17-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-17-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-17-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-17-10">10</a></span>
<span class="normal"><a href="#__codelineno-17-11">11</a></span>
<span class="normal"><a href="#__codelineno-17-12">12</a></span>
<span class="normal"><a href="#__codelineno-17-13">13</a></span>
<span class="normal"><a href="#__codelineno-17-14">14</a></span>
<span class="normal"><a href="#__codelineno-17-15">15</a></span>
<span class="normal"><a href="#__codelineno-17-16">16</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-17-1" name="__codelineno-17-1"></a><span class="ch">#!/bin/bash</span>
<a id="__codelineno-17-2" name="__codelineno-17-2"></a><span class="c1">#SBATCH --job-name=multithread          ### Name of the job</span>
<a id="__codelineno-17-3" name="__codelineno-17-3"></a><span class="c1">#SBATCH --nodes=1                       ### Number of Nodes</span>
<a id="__codelineno-17-4" name="__codelineno-17-4"></a><span class="c1">#SBATCH --ntasks=1                      ### Number of Tasks</span>
<a id="__codelineno-17-5" name="__codelineno-17-5"></a><span class="c1">#SBATCH --cpus-per-task=4               ### Number of Tasks per CPU</span>
<a id="__codelineno-17-6" name="__codelineno-17-6"></a><span class="c1">#SBATCH --mem=16G                       ### Memory required, 16 gigabyte</span>
<a id="__codelineno-17-7" name="__codelineno-17-7"></a><span class="c1">#SBATCH --partition=express             ### Cheaha Partition</span>
<a id="__codelineno-17-8" name="__codelineno-17-8"></a><span class="c1">#SBATCH --time=01:00:00                 ### Estimated Time of Completion, 1 hour</span>
<a id="__codelineno-17-9" name="__codelineno-17-9"></a><span class="c1">#SBATCH --output=%x_%j.out              ### Slurm Output file, %x is job name, %j is job id</span>
<a id="__codelineno-17-10" name="__codelineno-17-10"></a><span class="c1">#SBATCH --error=%x_%j.err               ### Slurm Error file, %x is job name, %j is job id</span>
<a id="__codelineno-17-11" name="__codelineno-17-11"></a>
<a id="__codelineno-17-12" name="__codelineno-17-12"></a><span class="c1">### Loading required MATLAB module</span>
<a id="__codelineno-17-13" name="__codelineno-17-13"></a>module<span class="w"> </span>load<span class="w"> </span>rc/matlab/R2023b
<a id="__codelineno-17-14" name="__codelineno-17-14"></a>
<a id="__codelineno-17-15" name="__codelineno-17-15"></a><span class="c1">### Executing the matlab script with input arguments</span>
<a id="__codelineno-17-16" name="__codelineno-17-16"></a>matlab<span class="w"> </span>-nosplash<span class="w"> </span>-nodesktop<span class="w"> </span>-r<span class="w"> </span><span class="s2">&quot;parfor_sum_array(100); quit;&quot;</span>
</code></pre></div></td></tr></table></div>
<p>Copy the below MATLAB script as <code>parfor_sum_array.m</code>. At the beginning, the script defines a function <code>sum_array</code> and variable <code>array_size</code> is passed as an input argument. This function uses multithreading with the <code>parfor</code> option to calculate the sum of elements in an array. On Line 10, the number of workers (<code>num_workers</code>) is set to the value of the environment variable <code>SLURM_CPUS_PER_TASK</code> i.e. 4. The script then creates a parallel pool using lines 13-17, utilizing the specified number of workers. The parallel computation of summing up of array elements is performed using a <code>parfor</code> loop in lines 23-27. By using <code>parfor</code> with a pool of workers, operations are run in parallel for improved performance. More insights on usage of <code>parfor</code> can be found in the official <a href="https://www.mathworks.com/help/matlab/ref/parfor.html">MATLAB page</a>.</p>
<!-- markdownlint-disable MD046 -->
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>Make sure that the <code>SLURM_CPUS_PER_TASK &gt; 1</code> in order to take advantage of multithreaded performance. It is important that the  <code>SLURM_CPUS_PER_TASK</code> does not exceed the number of workers and physical cores (i.e. CPU cores) available on the node. This is to prevent high context switching, where individual CPUs are constantly switching between multiple running processes, which can negatively impact job performance of all jobs running on the node. It may also lead to overhead during job execution and result in poorer performance. Please refer to our <a href="../../hardware/#hardware-information">Hardware page</a> to learn more about resource limits and selecting appropriate resources.</p>
</div>
<!-- markdownlint-disable MD046 -->

<!-- markdownlint-disable MD046 -->
<div class="admonition bug">
<p class="admonition-title">Bug</p>
<p>There is a known issue with <code>parpool</code> and other related multi-core parallel features such as <code>parfor</code> affecting R2022a and earlier. See our <a href="../../software/modules/#matlab-issues">Modules Known Issues section</a> for more information.</p>
</div>
<!-- markdownlint-enable MD046 -->

<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-18-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-18-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-18-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-18-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-18-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-18-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-18-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-18-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-18-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-18-10">10</a></span>
<span class="normal"><a href="#__codelineno-18-11">11</a></span>
<span class="normal"><a href="#__codelineno-18-12">12</a></span>
<span class="normal"><a href="#__codelineno-18-13">13</a></span>
<span class="normal"><a href="#__codelineno-18-14">14</a></span>
<span class="normal"><a href="#__codelineno-18-15">15</a></span>
<span class="normal"><a href="#__codelineno-18-16">16</a></span>
<span class="normal"><a href="#__codelineno-18-17">17</a></span>
<span class="normal"><a href="#__codelineno-18-18">18</a></span>
<span class="normal"><a href="#__codelineno-18-19">19</a></span>
<span class="normal"><a href="#__codelineno-18-20">20</a></span>
<span class="normal"><a href="#__codelineno-18-21">21</a></span>
<span class="normal"><a href="#__codelineno-18-22">22</a></span>
<span class="normal"><a href="#__codelineno-18-23">23</a></span>
<span class="normal"><a href="#__codelineno-18-24">24</a></span>
<span class="normal"><a href="#__codelineno-18-25">25</a></span>
<span class="normal"><a href="#__codelineno-18-26">26</a></span>
<span class="normal"><a href="#__codelineno-18-27">27</a></span>
<span class="normal"><a href="#__codelineno-18-28">28</a></span>
<span class="normal"><a href="#__codelineno-18-29">29</a></span>
<span class="normal"><a href="#__codelineno-18-30">30</a></span>
<span class="normal"><a href="#__codelineno-18-31">31</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-18-1" name="__codelineno-18-1"></a>%<span class="w"> </span>Function<span class="w"> </span>to<span class="w"> </span>calculate<span class="w"> </span>the<span class="w"> </span>sum<span class="w"> </span>of<span class="w"> </span>an<span class="w"> </span>array<span class="w"> </span><span class="k">in</span><span class="w"> </span>parallel.<span class="w"> </span>This<span class="w"> </span><span class="k">function</span><span class="w"> </span>takes<span class="w"> </span>array_size<span class="w"> </span>as<span class="w"> </span>input<span class="w"> </span>from<span class="w"> </span>command-line<span class="w"> </span>arguments
<a id="__codelineno-18-2" name="__codelineno-18-2"></a><span class="k">function</span><span class="w"> </span>sum_array<span class="o">(</span>array_size<span class="o">)</span>
<a id="__codelineno-18-3" name="__codelineno-18-3"></a><span class="w">    </span>%<span class="w"> </span>Check<span class="w"> </span><span class="k">if</span><span class="w"> </span>input<span class="w"> </span>array<span class="w"> </span>size<span class="w"> </span>is<span class="w"> </span>provided
<a id="__codelineno-18-4" name="__codelineno-18-4"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span>nargin<span class="w"> </span>&lt;<span class="w"> </span><span class="m">1</span>
<a id="__codelineno-18-5" name="__codelineno-18-5"></a><span class="w">        </span>disp<span class="o">(</span><span class="s1">&#39;error: pass input array size as arguments&#39;</span><span class="o">)</span><span class="p">;</span>
<a id="__codelineno-18-6" name="__codelineno-18-6"></a><span class="w">        </span><span class="k">return</span><span class="p">;</span>
<a id="__codelineno-18-7" name="__codelineno-18-7"></a><span class="w">    </span>end
<a id="__codelineno-18-8" name="__codelineno-18-8"></a>
<a id="__codelineno-18-9" name="__codelineno-18-9"></a><span class="w">    </span>%<span class="w"> </span>The<span class="w"> </span>number<span class="w"> </span>of<span class="w"> </span>workers<span class="w"> </span>is<span class="w"> </span><span class="nb">set</span><span class="w"> </span>based<span class="w"> </span>on<span class="w"> </span>Slurm<span class="w"> </span>parameter<span class="w"> </span>i.e.<span class="w"> </span>number<span class="w"> </span>of<span class="w"> </span>CPUS<span class="w"> </span>per<span class="w"> </span>task
<a id="__codelineno-18-10" name="__codelineno-18-10"></a><span class="w">    </span><span class="nv">num_workers</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>str2double<span class="o">(</span>getenv<span class="o">(</span><span class="s1">&#39;SLURM_CPUS_PER_TASK&#39;</span><span class="o">))</span><span class="p">;</span>
<a id="__codelineno-18-11" name="__codelineno-18-11"></a>
<a id="__codelineno-18-12" name="__codelineno-18-12"></a><span class="w">    </span>%<span class="w"> </span>Create<span class="w"> </span>parallel<span class="w"> </span>pool
<a id="__codelineno-18-13" name="__codelineno-18-13"></a><span class="w">    </span><span class="nv">poolobj</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>gcp<span class="o">(</span><span class="s1">&#39;nocreate&#39;</span><span class="o">)</span><span class="p">;</span>
<a id="__codelineno-18-14" name="__codelineno-18-14"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span>isempty<span class="o">(</span>poolobj<span class="o">)</span><span class="w"> </span><span class="o">||</span><span class="w"> </span>poolobj.NumWorkers<span class="w"> </span>~<span class="o">=</span><span class="w"> </span>num_workers
<a id="__codelineno-18-15" name="__codelineno-18-15"></a><span class="w">        </span>delete<span class="o">(</span>poolobj<span class="o">)</span><span class="p">;</span>
<a id="__codelineno-18-16" name="__codelineno-18-16"></a><span class="w">        </span>parpool<span class="o">(</span>num_workers<span class="o">)</span><span class="p">;</span>
<a id="__codelineno-18-17" name="__codelineno-18-17"></a><span class="w">    </span>end
<a id="__codelineno-18-18" name="__codelineno-18-18"></a>
<a id="__codelineno-18-19" name="__codelineno-18-19"></a><span class="w">    </span>%<span class="w"> </span>Initialization<span class="w"> </span>of<span class="w"> </span>Array
<a id="__codelineno-18-20" name="__codelineno-18-20"></a><span class="w">    </span><span class="nv">A</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>zeros<span class="o">(</span><span class="m">1</span>,<span class="w"> </span>array_size<span class="o">)</span><span class="p">;</span>
<a id="__codelineno-18-21" name="__codelineno-18-21"></a>
<a id="__codelineno-18-22" name="__codelineno-18-22"></a><span class="w">    </span>%<span class="w"> </span>Perform<span class="w"> </span>parallel<span class="w"> </span>computation<span class="w"> </span><span class="k">for</span><span class="w"> </span>each<span class="w"> </span>element<span class="w"> </span>of<span class="w"> </span>the<span class="w"> </span>array
<a id="__codelineno-18-23" name="__codelineno-18-23"></a><span class="w">    </span><span class="nv">sum_result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span><span class="p">;</span>
<a id="__codelineno-18-24" name="__codelineno-18-24"></a><span class="w">    </span>parfor<span class="w"> </span><span class="nv">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span>:array_size
<a id="__codelineno-18-25" name="__codelineno-18-25"></a><span class="w">        </span>A<span class="o">(</span>i<span class="o">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>i<span class="p">;</span>
<a id="__codelineno-18-26" name="__codelineno-18-26"></a><span class="w">        </span><span class="nv">sum_result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>sum_result<span class="w"> </span>+<span class="w"> </span>A<span class="o">(</span>i<span class="o">)</span><span class="p">;</span>
<a id="__codelineno-18-27" name="__codelineno-18-27"></a><span class="w">    </span>end
<a id="__codelineno-18-28" name="__codelineno-18-28"></a>
<a id="__codelineno-18-29" name="__codelineno-18-29"></a><span class="w">    </span>%<span class="w"> </span>Display<span class="w"> </span>the<span class="w"> </span>total<span class="w"> </span>sum
<a id="__codelineno-18-30" name="__codelineno-18-30"></a><span class="w">    </span>disp<span class="o">([</span><span class="s1">&#39;Sum of array is: &#39;</span><span class="w"> </span>num2str<span class="o">(</span>sum_result<span class="o">)])</span><span class="p">;</span>
<a id="__codelineno-18-31" name="__codelineno-18-31"></a>end
</code></pre></div></td></tr></table></div>
<p>The below result summarizes the parallel pool initialization and its utilization of 4 workers for  computation of sum of an array. Followed by, the <code>sacct</code> report illustrates that the multithreaded job was allocated with 4 CPUs and was successfully completed.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-19-1" name="__codelineno-19-1" href="#__codelineno-19-1"></a>$<span class="w"> </span>cat<span class="w"> </span>multithread_27105035.out
<a id="__codelineno-19-2" name="__codelineno-19-2" href="#__codelineno-19-2"></a>
<a id="__codelineno-19-3" name="__codelineno-19-3" href="#__codelineno-19-3"></a>MATLAB<span class="w"> </span>is<span class="w"> </span>selecting<span class="w"> </span>SOFTWARE<span class="w"> </span>OPENGL<span class="w"> </span>rendering.
<a id="__codelineno-19-4" name="__codelineno-19-4" href="#__codelineno-19-4"></a>
<a id="__codelineno-19-5" name="__codelineno-19-5" href="#__codelineno-19-5"></a><span class="w">                            </span>&lt;<span class="w"> </span>M<span class="w"> </span>A<span class="w"> </span>T<span class="w"> </span>L<span class="w"> </span>A<span class="w"> </span>B<span class="w"> </span><span class="o">(</span>R<span class="o">)</span><span class="w"> </span>&gt;
<a id="__codelineno-19-6" name="__codelineno-19-6" href="#__codelineno-19-6"></a><span class="w">                  </span>Copyright<span class="w"> </span><span class="m">1984</span>-2023<span class="w"> </span>The<span class="w"> </span>MathWorks,<span class="w"> </span>Inc.
<a id="__codelineno-19-7" name="__codelineno-19-7" href="#__codelineno-19-7"></a><span class="w">             </span>R2023b<span class="w"> </span>Update<span class="w"> </span><span class="m">6</span><span class="w"> </span><span class="o">(</span><span class="m">23</span>.2.0.2485118<span class="o">)</span><span class="w"> </span><span class="m">64</span>-bit<span class="w"> </span><span class="o">(</span>glnxa64<span class="o">)</span>
<a id="__codelineno-19-8" name="__codelineno-19-8" href="#__codelineno-19-8"></a><span class="w">                             </span>December<span class="w"> </span><span class="m">28</span>,<span class="w"> </span><span class="m">2023</span>
<a id="__codelineno-19-9" name="__codelineno-19-9" href="#__codelineno-19-9"></a>
<a id="__codelineno-19-10" name="__codelineno-19-10" href="#__codelineno-19-10"></a>To<span class="w"> </span>get<span class="w"> </span>started,<span class="w"> </span><span class="nb">type</span><span class="w"> </span>doc.
<a id="__codelineno-19-11" name="__codelineno-19-11" href="#__codelineno-19-11"></a>For<span class="w"> </span>product<span class="w"> </span>information,<span class="w"> </span>visit<span class="w"> </span>www.mathworks.com.
<a id="__codelineno-19-12" name="__codelineno-19-12" href="#__codelineno-19-12"></a>
<a id="__codelineno-19-13" name="__codelineno-19-13" href="#__codelineno-19-13"></a>Starting<span class="w"> </span>parallel<span class="w"> </span>pool<span class="w"> </span><span class="o">(</span>parpool<span class="o">)</span><span class="w"> </span>using<span class="w"> </span>the<span class="w"> </span><span class="s1">&#39;Processes&#39;</span><span class="w"> </span>profile<span class="w"> </span>...
<a id="__codelineno-19-14" name="__codelineno-19-14" href="#__codelineno-19-14"></a>Connected<span class="w"> </span>to<span class="w"> </span>parallel<span class="w"> </span>pool<span class="w"> </span>with<span class="w"> </span><span class="m">4</span><span class="w"> </span>workers.
<a id="__codelineno-19-15" name="__codelineno-19-15" href="#__codelineno-19-15"></a>Sum<span class="w"> </span>of<span class="w"> </span>array<span class="w"> </span>is:<span class="w"> </span><span class="m">5050</span>
<a id="__codelineno-19-16" name="__codelineno-19-16" href="#__codelineno-19-16"></a>Parallel<span class="w"> </span>pool<span class="w"> </span>using<span class="w"> </span>the<span class="w"> </span><span class="s1">&#39;Processes&#39;</span><span class="w"> </span>profile<span class="w"> </span>is<span class="w"> </span>shutting<span class="w"> </span>down.
</code></pre></div>
<div class="highlight"><pre><span></span><code><a id="__codelineno-20-1" name="__codelineno-20-1" href="#__codelineno-20-1"></a>$<span class="w"> </span>sacct<span class="w"> </span>-j<span class="w"> </span><span class="m">27105035</span>
<a id="__codelineno-20-2" name="__codelineno-20-2" href="#__codelineno-20-2"></a>
<a id="__codelineno-20-3" name="__codelineno-20-3" href="#__codelineno-20-3"></a><span class="w">       </span>JobID<span class="w">    </span>JobName<span class="w">  </span>Partition<span class="w">    </span>Account<span class="w">  </span>AllocCPUS<span class="w">      </span>State<span class="w"> </span>ExitCode
<a id="__codelineno-20-4" name="__codelineno-20-4" href="#__codelineno-20-4"></a>------------<span class="w"> </span>----------<span class="w"> </span>----------<span class="w"> </span>----------<span class="w"> </span>----------<span class="w"> </span>----------<span class="w"> </span>--------
<a id="__codelineno-20-5" name="__codelineno-20-5" href="#__codelineno-20-5"></a><span class="m">27105035</span><span class="w">     </span>multithre+<span class="w">    </span>express<span class="w">      </span>USER<span class="w">          </span><span class="m">4</span><span class="w">  </span>COMPLETED<span class="w">      </span><span class="m">0</span>:0
<a id="__codelineno-20-6" name="__codelineno-20-6" href="#__codelineno-20-6"></a><span class="m">27105035</span>.ba+<span class="w">      </span>batch<span class="w">                 </span>USER<span class="w">          </span><span class="m">4</span><span class="w">  </span>COMPLETED<span class="w">      </span><span class="m">0</span>:0
<a id="__codelineno-20-7" name="__codelineno-20-7" href="#__codelineno-20-7"></a><span class="m">27105035</span>.ex+<span class="w">     </span>extern<span class="w">                 </span>USER<span class="w">          </span><span class="m">4</span><span class="w">  </span>COMPLETED<span class="w">      </span><span class="m">0</span>:0
</code></pre></div>
<h3 id="example-6-gpu-job">Example 6: GPU Job<a class="headerlink" href="#example-6-gpu-job" title="Permanent link">&para;</a></h3>
<p>This slurm script shows the execution of Tensorflow job using GPU resources. Let us save this script as <code>gpu.job</code>. The Slurm parameter <code>--gres=gpu:2</code> in line 6, requests for 2 GPUs. In line 8, note that in order to run GPU-based jobs, either the <code>amperenodes</code> or <code>pascalnodes</code> partition must be used (please refer to our <a href="../gpu/">GPU page</a> for more information). Lines 14-15 loads the necessary CUDA modules, while lines 18-19 load the Anaconda module and activate a <code>conda</code> environment called <code>tensorflow</code>. Refer to <a href="https://www.tensorflow.org/">Tensorflow official page</a> for installation. The last line executes a python script that utilizes Tensorflow library to perform matrix multiplication across multiple GPUs.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-21-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-21-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-21-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-21-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-21-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-21-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-21-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-21-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-21-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-21-10">10</a></span>
<span class="normal"><a href="#__codelineno-21-11">11</a></span>
<span class="normal"><a href="#__codelineno-21-12">12</a></span>
<span class="normal"><a href="#__codelineno-21-13">13</a></span>
<span class="normal"><a href="#__codelineno-21-14">14</a></span>
<span class="normal"><a href="#__codelineno-21-15">15</a></span>
<span class="normal"><a href="#__codelineno-21-16">16</a></span>
<span class="normal"><a href="#__codelineno-21-17">17</a></span>
<span class="normal"><a href="#__codelineno-21-18">18</a></span>
<span class="normal"><a href="#__codelineno-21-19">19</a></span>
<span class="normal"><a href="#__codelineno-21-20">20</a></span>
<span class="normal"><a href="#__codelineno-21-21">21</a></span>
<span class="normal"><a href="#__codelineno-21-22">22</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-21-1" name="__codelineno-21-1"></a><span class="ch">#!/bin/bash</span>
<a id="__codelineno-21-2" name="__codelineno-21-2"></a><span class="c1">#SBATCH --job-name=gpu              ### Name of the job</span>
<a id="__codelineno-21-3" name="__codelineno-21-3"></a><span class="c1">#SBATCH --nodes=1                   ### Number of Nodes</span>
<a id="__codelineno-21-4" name="__codelineno-21-4"></a><span class="c1">#SBATCH --ntasks=1                  ### Number of Tasks</span>
<a id="__codelineno-21-5" name="__codelineno-21-5"></a><span class="c1">#SBATCH --cpus-per-task=1           ### Number of Tasks per CPU</span>
<a id="__codelineno-21-6" name="__codelineno-21-6"></a><span class="c1">#SBATCH --gres=gpu:2                ### Number of GPUs, 2 GPUs</span>
<a id="__codelineno-21-7" name="__codelineno-21-7"></a><span class="c1">#SBATCH --mem=16G                   ### Memory required, 16 gigabyte</span>
<a id="__codelineno-21-8" name="__codelineno-21-8"></a><span class="c1">#SBATCH --partition=amperenodes     ### Cheaha Partition</span>
<a id="__codelineno-21-9" name="__codelineno-21-9"></a><span class="c1">#SBATCH --time=01:00:00             ### Estimated Time of Completion, 1 hour</span>
<a id="__codelineno-21-10" name="__codelineno-21-10"></a><span class="c1">#SBATCH --output=%x_%j.out          ### Slurm Output file, %x is job name, %j is job id</span>
<a id="__codelineno-21-11" name="__codelineno-21-11"></a><span class="c1">#SBATCH --error=%x_%j.err           ### Slurm Error file, %x is job name, %j is job id</span>
<a id="__codelineno-21-12" name="__codelineno-21-12"></a>
<a id="__codelineno-21-13" name="__codelineno-21-13"></a><span class="c1">### Loading the required CUDA and cuDNN modules</span>
<a id="__codelineno-21-14" name="__codelineno-21-14"></a>module<span class="w"> </span>load<span class="w"> </span>CUDA/12.2.0
<a id="__codelineno-21-15" name="__codelineno-21-15"></a>module<span class="w"> </span>load<span class="w"> </span>cuDNN/8.9.2.26-CUDA-12.2.0
<a id="__codelineno-21-16" name="__codelineno-21-16"></a>
<a id="__codelineno-21-17" name="__codelineno-21-17"></a><span class="c1">### Loading the Anaconda module and activating the `tensorflow` environment</span>
<a id="__codelineno-21-18" name="__codelineno-21-18"></a>module<span class="w"> </span>load<span class="w"> </span>Anaconda3
<a id="__codelineno-21-19" name="__codelineno-21-19"></a>conda<span class="w"> </span>activate<span class="w"> </span>tensorflow
<a id="__codelineno-21-20" name="__codelineno-21-20"></a>
<a id="__codelineno-21-21" name="__codelineno-21-21"></a><span class="c1">### Executing the python script</span>
<a id="__codelineno-21-22" name="__codelineno-21-22"></a>python<span class="w"> </span>matmul_tensorflow.py
</code></pre></div></td></tr></table></div>
<p>Let us now create a file named <code>matmul_tensorflow.py</code> and copy the following script into it. This python script demonstrates the utilization of Tensorflow library to distribute computational tasks among multiple GPUs, in order to perform matrix multiplication in parallel (Lines 11-19). Lines 8-9 retrieve the logical GPUs and enable device placement logging, which helps to analyze which device is used for each operation. The final results are aggregated and the sum is computed on the CPU device (lines 22-23).</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-22-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-22-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-22-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-22-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-22-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-22-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-22-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-22-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-22-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-22-10">10</a></span>
<span class="normal"><a href="#__codelineno-22-11">11</a></span>
<span class="normal"><a href="#__codelineno-22-12">12</a></span>
<span class="normal"><a href="#__codelineno-22-13">13</a></span>
<span class="normal"><a href="#__codelineno-22-14">14</a></span>
<span class="normal"><a href="#__codelineno-22-15">15</a></span>
<span class="normal"><a href="#__codelineno-22-16">16</a></span>
<span class="normal"><a href="#__codelineno-22-17">17</a></span>
<span class="normal"><a href="#__codelineno-22-18">18</a></span>
<span class="normal"><a href="#__codelineno-22-19">19</a></span>
<span class="normal"><a href="#__codelineno-22-20">20</a></span>
<span class="normal"><a href="#__codelineno-22-21">21</a></span>
<span class="normal"><a href="#__codelineno-22-22">22</a></span>
<span class="normal"><a href="#__codelineno-22-23">23</a></span>
<span class="normal"><a href="#__codelineno-22-24">24</a></span>
<span class="normal"><a href="#__codelineno-22-25">25</a></span>
<span class="normal"><a href="#__codelineno-22-26">26</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-22-1" name="__codelineno-22-1"></a>import<span class="w"> </span>tensorflow<span class="w"> </span>as<span class="w"> </span>tf
<a id="__codelineno-22-2" name="__codelineno-22-2"></a>
<a id="__codelineno-22-3" name="__codelineno-22-3"></a><span class="c1">### Print Tensorflow version and check for available number of GPUs</span>
<a id="__codelineno-22-4" name="__codelineno-22-4"></a>print<span class="o">(</span><span class="s2">&quot;TensorFlow version:&quot;</span>,<span class="w"> </span>tf.__version__<span class="o">)</span>
<a id="__codelineno-22-5" name="__codelineno-22-5"></a>print<span class="o">(</span><span class="s2">&quot;Num GPUs Available: &quot;</span>,<span class="w"> </span>len<span class="o">(</span>tf.config.list_physical_devices<span class="o">(</span><span class="s1">&#39;GPU&#39;</span><span class="o">)))</span>
<a id="__codelineno-22-6" name="__codelineno-22-6"></a>
<a id="__codelineno-22-7" name="__codelineno-22-7"></a><span class="c1">### Get the logical GPUs and enable device placement</span>
<a id="__codelineno-22-8" name="__codelineno-22-8"></a><span class="nv">gpus</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>tf.config.list_logical_devices<span class="o">(</span><span class="s1">&#39;GPU&#39;</span><span class="o">)</span>
<a id="__codelineno-22-9" name="__codelineno-22-9"></a>tf.debugging.set_log_device_placement<span class="o">(</span>True<span class="o">)</span>
<a id="__codelineno-22-10" name="__codelineno-22-10"></a>
<a id="__codelineno-22-11" name="__codelineno-22-11"></a><span class="k">if</span><span class="w"> </span>gpus:
<a id="__codelineno-22-12" name="__codelineno-22-12"></a><span class="w">    </span><span class="c1">### Create tensors on each GPU and Perform matrix multiplication on multiple GPUs</span>
<a id="__codelineno-22-13" name="__codelineno-22-13"></a><span class="w">    </span><span class="nv">c</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">[]</span>
<a id="__codelineno-22-14" name="__codelineno-22-14"></a><span class="w">    </span><span class="k">for</span><span class="w"> </span>gpu<span class="w"> </span><span class="k">in</span><span class="w"> </span>gpus:
<a id="__codelineno-22-15" name="__codelineno-22-15"></a><span class="w">        </span>with<span class="w"> </span>tf.device<span class="o">(</span>gpu.name<span class="o">)</span>:
<a id="__codelineno-22-16" name="__codelineno-22-16"></a><span class="w">            </span><span class="nv">a</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>tf.random.uniform<span class="o">(</span><span class="nv">shape</span><span class="o">=(</span><span class="m">4</span>,<span class="w"> </span><span class="m">3</span><span class="o">))</span>
<a id="__codelineno-22-17" name="__codelineno-22-17"></a><span class="w">            </span><span class="nv">b</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>tf.random.uniform<span class="o">(</span><span class="nv">shape</span><span class="o">=(</span><span class="m">3</span>,<span class="w"> </span><span class="m">4</span><span class="o">))</span>
<a id="__codelineno-22-18" name="__codelineno-22-18"></a><span class="w">            </span>c.append<span class="o">(</span>tf.matmul<span class="o">(</span>a,<span class="w"> </span>b<span class="o">))</span>
<a id="__codelineno-22-19" name="__codelineno-22-19"></a><span class="w">            </span>print<span class="o">(</span>f<span class="s2">&quot;Computation on GPU: {gpu.name}&quot;</span><span class="o">)</span>
<a id="__codelineno-22-20" name="__codelineno-22-20"></a>
<a id="__codelineno-22-21" name="__codelineno-22-21"></a><span class="w">    </span><span class="c1">### Calculate the Sum on CPU device</span>
<a id="__codelineno-22-22" name="__codelineno-22-22"></a><span class="w">    </span>with<span class="w"> </span>tf.device<span class="o">(</span><span class="s1">&#39;/CPU:0&#39;</span><span class="o">)</span>:
<a id="__codelineno-22-23" name="__codelineno-22-23"></a><span class="w">        </span><span class="nv">matmul_sum</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>tf.add_n<span class="o">(</span>c<span class="o">)</span>
<a id="__codelineno-22-24" name="__codelineno-22-24"></a>
<a id="__codelineno-22-25" name="__codelineno-22-25"></a><span class="w">    </span><span class="c1">### Print the result</span>
<a id="__codelineno-22-26" name="__codelineno-22-26"></a><span class="w">    </span>print<span class="o">(</span>matmul_sum<span class="o">)</span>
</code></pre></div></td></tr></table></div>
<p>The results indicate that the Tensorflow version utilized is 2.15. The segments <code>/device:GPU:0</code> and <code>/device:GPU:1</code> specify that the computations were executed on two GPUs. The final results is a 4x4 matrix obtained by summing the matrix multiplication results. In the <code>sacct</code> report, the column <code>AllocGRES</code> shows that 2 GPUs are allocated for this job.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-23-1" name="__codelineno-23-1" href="#__codelineno-23-1"></a>$<span class="w"> </span>cat<span class="w"> </span>gpu_27107694.out
<a id="__codelineno-23-2" name="__codelineno-23-2" href="#__codelineno-23-2"></a>
<a id="__codelineno-23-3" name="__codelineno-23-3" href="#__codelineno-23-3"></a>TensorFlow<span class="w"> </span>version:<span class="w"> </span><span class="m">2</span>.15.0
<a id="__codelineno-23-4" name="__codelineno-23-4" href="#__codelineno-23-4"></a>Num<span class="w"> </span>GPUs<span class="w"> </span>Available:<span class="w">  </span><span class="m">2</span>
<a id="__codelineno-23-5" name="__codelineno-23-5" href="#__codelineno-23-5"></a>Computation<span class="w"> </span>on<span class="w"> </span>GPU:<span class="w"> </span>/device:GPU:0
<a id="__codelineno-23-6" name="__codelineno-23-6" href="#__codelineno-23-6"></a>Computation<span class="w"> </span>on<span class="w"> </span>GPU:<span class="w"> </span>/device:GPU:1
<a id="__codelineno-23-7" name="__codelineno-23-7" href="#__codelineno-23-7"></a>tf.Tensor<span class="o">(</span>
<a id="__codelineno-23-8" name="__codelineno-23-8" href="#__codelineno-23-8"></a><span class="o">[[</span><span class="m">1</span>.6408134<span class="w"> </span><span class="m">0</span>.9900811<span class="w"> </span><span class="m">1</span>.3046092<span class="w"> </span><span class="m">0</span>.9307438<span class="o">]</span>
<a id="__codelineno-23-9" name="__codelineno-23-9" href="#__codelineno-23-9"></a><span class="w"> </span><span class="o">[</span><span class="m">1</span>.5603762<span class="w"> </span><span class="m">1</span>.6812123<span class="w"> </span><span class="m">1</span>.8867838<span class="w"> </span><span class="m">1</span>.0662912<span class="o">]</span>
<a id="__codelineno-23-10" name="__codelineno-23-10" href="#__codelineno-23-10"></a><span class="w"> </span><span class="o">[</span><span class="m">2</span>.481688<span class="w">  </span><span class="m">1</span>.8107605<span class="w"> </span><span class="m">2</span>.0444224<span class="w"> </span><span class="m">1</span>.5500932<span class="o">]</span>
<a id="__codelineno-23-11" name="__codelineno-23-11" href="#__codelineno-23-11"></a><span class="w"> </span><span class="o">[</span><span class="m">2</span>.415476<span class="w">  </span><span class="m">1</span>.9280369<span class="w"> </span><span class="m">2</span>.020216<span class="w">  </span><span class="m">1</span>.4872619<span class="o">]]</span>,<span class="w"> </span><span class="nv">shape</span><span class="o">=(</span><span class="m">4</span>,<span class="w"> </span><span class="m">4</span><span class="o">)</span>,<span class="w"> </span><span class="nv">dtype</span><span class="o">=</span>float32<span class="o">)</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><a id="__codelineno-24-1" name="__codelineno-24-1" href="#__codelineno-24-1"></a>$<span class="w"> </span>sacct<span class="w"> </span>-j<span class="w"> </span><span class="m">27107694</span><span class="w"> </span>--format<span class="o">=</span>JobID,JobName,Partition,Account,AllocCPUS,allocgres,State,ExitCode
<a id="__codelineno-24-2" name="__codelineno-24-2" href="#__codelineno-24-2"></a>
<a id="__codelineno-24-3" name="__codelineno-24-3" href="#__codelineno-24-3"></a><span class="w">       </span>JobID<span class="w">    </span>JobName<span class="w">  </span>Partition<span class="w">    </span>Account<span class="w">  </span>AllocCPUS<span class="w">    </span>AllocGRES<span class="w">      </span>State<span class="w"> </span>ExitCode
<a id="__codelineno-24-4" name="__codelineno-24-4" href="#__codelineno-24-4"></a>------------<span class="w"> </span>----------<span class="w"> </span>----------<span class="w"> </span>----------<span class="w"> </span>----------<span class="w"> </span>------------<span class="w"> </span>----------<span class="w"> </span>--------
<a id="__codelineno-24-5" name="__codelineno-24-5" href="#__codelineno-24-5"></a><span class="m">27107694</span><span class="w">            </span>gpu<span class="w"> </span>amperenod+<span class="w">      </span>USER<span class="w">          </span><span class="m">1</span><span class="w">        </span>gpu:2<span class="w">  </span>COMPLETED<span class="w">      </span><span class="m">0</span>:0
<a id="__codelineno-24-6" name="__codelineno-24-6" href="#__codelineno-24-6"></a><span class="m">27107694</span>.ba+<span class="w">      </span>batch<span class="w">                 </span>USER<span class="w">          </span><span class="m">1</span><span class="w">        </span>gpu:2<span class="w">  </span>COMPLETED<span class="w">      </span><span class="m">0</span>:0
<a id="__codelineno-24-7" name="__codelineno-24-7" href="#__codelineno-24-7"></a><span class="m">27107694</span>.ex+<span class="w">     </span>extern<span class="w">                 </span>USER<span class="w">          </span><span class="m">1</span><span class="w">        </span>gpu:2<span class="w">  </span>COMPLETED<span class="w">      </span><span class="m">0</span>:0
</code></pre></div>
<h3 id="example-7-multinode-job">Example 7: Multinode Job<a class="headerlink" href="#example-7-multinode-job" title="Permanent link">&para;</a></h3>
<p>The below Slurm script runs a Quantum Expresso job using the <code>pw.x</code> executable on multiple nodes. In this example, we request for 2 nodes on <code>amd-hdr100</code> partition in lines 4 and 7. The suitable Quantum Expresso module is loaded in line 13. The last line is configured for a parallel computation of Quantum Expresso simulation across 2 nodes <code>N 2</code> and 4 MPI processes <code>-nk 4</code> for the input parameters in <code>pw.scf.silicon.in</code>. The input file <code>pw.scf.silicon.in</code> and psuedo potential file is taken from the <a href="https://pranabdas.github.io/espresso/hands-on/scf/">github page</a>. However this input is subject to change, hence according to your use case you can change the inputs.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-25-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-25-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-25-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-25-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-25-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-25-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-25-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-25-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-25-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-25-10">10</a></span>
<span class="normal"><a href="#__codelineno-25-11">11</a></span>
<span class="normal"><a href="#__codelineno-25-12">12</a></span>
<span class="normal"><a href="#__codelineno-25-13">13</a></span>
<span class="normal"><a href="#__codelineno-25-14">14</a></span>
<span class="normal"><a href="#__codelineno-25-15">15</a></span>
<span class="normal"><a href="#__codelineno-25-16">16</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-25-1" name="__codelineno-25-1"></a><span class="ch">#!/bin/bash</span>
<a id="__codelineno-25-2" name="__codelineno-25-2"></a>
<a id="__codelineno-25-3" name="__codelineno-25-3"></a><span class="c1">#SBATCH --job-name=mpijob               ### Name of the job</span>
<a id="__codelineno-25-4" name="__codelineno-25-4"></a><span class="c1">#SBATCH --nodes=2                       ### Number of Nodes</span>
<a id="__codelineno-25-5" name="__codelineno-25-5"></a><span class="c1">#SBATCH --ntasks 4                      ### Number of Tasks</span>
<a id="__codelineno-25-6" name="__codelineno-25-6"></a><span class="c1">#SBATCH --mem=64G                       ### Memory required, 64 gigabyte</span>
<a id="__codelineno-25-7" name="__codelineno-25-7"></a><span class="c1">#SBATCH --partition=amd-hdr100          ### Cheaha Partition</span>
<a id="__codelineno-25-8" name="__codelineno-25-8"></a><span class="c1">#SBATCH --time=12:00:00                 ### Estimated Time of Completion, 12 hour</span>
<a id="__codelineno-25-9" name="__codelineno-25-9"></a><span class="c1">#SBATCH --output=%x_%j.out              ### Slurm Output file, %x is job name, %j is job id</span>
<a id="__codelineno-25-10" name="__codelineno-25-10"></a><span class="c1">#SBATCH --error=%x_%j.err               ### Slurm Error file, %x is job name, %j is job id</span>
<a id="__codelineno-25-11" name="__codelineno-25-11"></a>
<a id="__codelineno-25-12" name="__codelineno-25-12"></a><span class="c1">### Load the suitable Quantum Expresso module</span>
<a id="__codelineno-25-13" name="__codelineno-25-13"></a>module<span class="w"> </span>load<span class="w"> </span>QuantumESPRESSO/6.3-foss-2018b
<a id="__codelineno-25-14" name="__codelineno-25-14"></a>
<a id="__codelineno-25-15" name="__codelineno-25-15"></a><span class="c1">### Executes the executable &quot;pw.x&quot; across 2 nodes and 4 processes/CPU cores for the input `pw.scf.silicon.in`</span>
<a id="__codelineno-25-16" name="__codelineno-25-16"></a>srun<span class="w"> </span>--mpi<span class="o">=</span>pmix_v3<span class="w"> </span>-N<span class="w"> </span><span class="m">2</span><span class="w"> </span>pw.x<span class="w"> </span>-nk<span class="w"> </span><span class="m">4</span><span class="w"> </span>-i<span class="w"> </span>pw.scf.silicon.in
</code></pre></div></td></tr></table></div>
<p>The below output shows that the workflow has been distributed across 2 nodes, with a total of 4 pools. The computations are performed based on these above-mentioned parallel execution configuration. Also, displays the metrics such as parallelization, overall performance, and successful job completion status. Note that the results only display essential information to aid in understanding the execution of this multi-node job. And, the <code>sacct</code> report indicates that the job is allocated with 4 CPUs across 2 nodes, and was completed successfully.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-26-1" name="__codelineno-26-1" href="#__codelineno-26-1"></a>$<span class="w"> </span>cat<span class="w"> </span>multinode_27108398.out
<a id="__codelineno-26-2" name="__codelineno-26-2" href="#__codelineno-26-2"></a>
<a id="__codelineno-26-3" name="__codelineno-26-3" href="#__codelineno-26-3"></a>Program<span class="w"> </span>PWSCF<span class="w"> </span>v.6.3MaX<span class="w"> </span>starts<span class="w"> </span>on<span class="w">  </span>8Mar2024<span class="w"> </span>at<span class="w"> </span><span class="m">13</span>:18:37
<a id="__codelineno-26-4" name="__codelineno-26-4" href="#__codelineno-26-4"></a>
<a id="__codelineno-26-5" name="__codelineno-26-5" href="#__codelineno-26-5"></a><span class="w">     </span>This<span class="w"> </span>program<span class="w"> </span>is<span class="w"> </span>part<span class="w"> </span>of<span class="w"> </span>the<span class="w"> </span>open-source<span class="w"> </span>Quantum<span class="w"> </span>ESPRESSO<span class="w"> </span>suite
<a id="__codelineno-26-6" name="__codelineno-26-6" href="#__codelineno-26-6"></a><span class="w">     </span><span class="k">for</span><span class="w"> </span>quantum<span class="w"> </span>simulation<span class="w"> </span>of<span class="w"> </span>materials<span class="p">;</span><span class="w"> </span>please<span class="w"> </span>cite
<a id="__codelineno-26-7" name="__codelineno-26-7" href="#__codelineno-26-7"></a><span class="w">         </span><span class="s2">&quot;P. Giannozzi et al., J. Phys.:Condens. Matter 21 395502 (2009);</span>
<a id="__codelineno-26-8" name="__codelineno-26-8" href="#__codelineno-26-8"></a><span class="s2">         &quot;</span>P.<span class="w"> </span>Giannozzi<span class="w"> </span>et<span class="w"> </span>al.,<span class="w"> </span>J.<span class="w"> </span>Phys.:Condens.<span class="w"> </span>Matter<span class="w"> </span><span class="m">29</span><span class="w"> </span><span class="m">465901</span><span class="w"> </span><span class="o">(</span><span class="m">2017</span><span class="o">)</span><span class="p">;</span>
<a id="__codelineno-26-9" name="__codelineno-26-9" href="#__codelineno-26-9"></a><span class="w">          </span>URL<span class="w"> </span>http://www.quantum-espresso.org<span class="s2">&quot;,</span>
<a id="__codelineno-26-10" name="__codelineno-26-10" href="#__codelineno-26-10"></a><span class="s2">     in publications or presentations arising from this work. More details at</span>
<a id="__codelineno-26-11" name="__codelineno-26-11" href="#__codelineno-26-11"></a><span class="s2">     http://www.quantum-espresso.org/quote</span>
<a id="__codelineno-26-12" name="__codelineno-26-12" href="#__codelineno-26-12"></a>
<a id="__codelineno-26-13" name="__codelineno-26-13" href="#__codelineno-26-13"></a><span class="s2">     Parallel version (MPI &amp; OpenMP), running on       4 processor cores</span>
<a id="__codelineno-26-14" name="__codelineno-26-14" href="#__codelineno-26-14"></a><span class="s2">     Number of MPI processes:                 4</span>
<a id="__codelineno-26-15" name="__codelineno-26-15" href="#__codelineno-26-15"></a><span class="s2">     Threads/MPI process:                     1</span>
<a id="__codelineno-26-16" name="__codelineno-26-16" href="#__codelineno-26-16"></a>
<a id="__codelineno-26-17" name="__codelineno-26-17" href="#__codelineno-26-17"></a><span class="s2">     MPI processes distributed on     2 nodes</span>
<a id="__codelineno-26-18" name="__codelineno-26-18" href="#__codelineno-26-18"></a><span class="s2">     K-points division:     npool     =       4</span>
<a id="__codelineno-26-19" name="__codelineno-26-19" href="#__codelineno-26-19"></a><span class="s2">     Reading input from pw.scf.silicon.in</span>
<a id="__codelineno-26-20" name="__codelineno-26-20" href="#__codelineno-26-20"></a>
<a id="__codelineno-26-21" name="__codelineno-26-21" href="#__codelineno-26-21"></a><span class="s2">     Current dimensions of program PWSCF are:</span>
<a id="__codelineno-26-22" name="__codelineno-26-22" href="#__codelineno-26-22"></a><span class="s2">     Max number of different atomic species (ntypx) = 10</span>
<a id="__codelineno-26-23" name="__codelineno-26-23" href="#__codelineno-26-23"></a><span class="s2">     Max number of k-points (npk) =  40000</span>
<a id="__codelineno-26-24" name="__codelineno-26-24" href="#__codelineno-26-24"></a><span class="s2">     Max angular momentum in pseudopotentials (lmaxx) =  3</span>
<a id="__codelineno-26-25" name="__codelineno-26-25" href="#__codelineno-26-25"></a><span class="s2">     .....</span>
<a id="__codelineno-26-26" name="__codelineno-26-26" href="#__codelineno-26-26"></a><span class="s2">     .....</span>
<a id="__codelineno-26-27" name="__codelineno-26-27" href="#__codelineno-26-27"></a><span class="s2">          Parallel routines</span>
<a id="__codelineno-26-28" name="__codelineno-26-28" href="#__codelineno-26-28"></a>
<a id="__codelineno-26-29" name="__codelineno-26-29" href="#__codelineno-26-29"></a><span class="s2">     PWSCF        :     1.17s CPU         1.36s WALL</span>
<a id="__codelineno-26-30" name="__codelineno-26-30" href="#__codelineno-26-30"></a>
<a id="__codelineno-26-31" name="__codelineno-26-31" href="#__codelineno-26-31"></a><span class="s2">   This run was terminated on:  13:18:38   8Mar2024</span>
<a id="__codelineno-26-32" name="__codelineno-26-32" href="#__codelineno-26-32"></a><span class="s2">=------------------------------------------------------------------------------=</span>
<a id="__codelineno-26-33" name="__codelineno-26-33" href="#__codelineno-26-33"></a><span class="s2">   JOB DONE.</span>
<a id="__codelineno-26-34" name="__codelineno-26-34" href="#__codelineno-26-34"></a><span class="s2">=------------------------------------------------------------------------------=</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><a id="__codelineno-27-1" name="__codelineno-27-1" href="#__codelineno-27-1"></a>$<span class="w"> </span>sacct<span class="w"> </span>-j<span class="w"> </span><span class="m">27108398</span><span class="w"> </span>--format<span class="o">=</span>JobID,JobName,Partition,Account,AllocCPUS,AllocNodes,State,ExitCode
<a id="__codelineno-27-2" name="__codelineno-27-2" href="#__codelineno-27-2"></a>
<a id="__codelineno-27-3" name="__codelineno-27-3" href="#__codelineno-27-3"></a><span class="w">       </span>JobID<span class="w">    </span>JobName<span class="w">  </span>Partition<span class="w">    </span>Account<span class="w">  </span>AllocCPUS<span class="w"> </span>AllocNodes<span class="w">      </span>State<span class="w"> </span>ExitCode
<a id="__codelineno-27-4" name="__codelineno-27-4" href="#__codelineno-27-4"></a>------------<span class="w"> </span>----------<span class="w"> </span>----------<span class="w"> </span>----------<span class="w"> </span>----------<span class="w"> </span>----------<span class="w"> </span>----------<span class="w"> </span>--------
<a id="__codelineno-27-5" name="__codelineno-27-5" href="#__codelineno-27-5"></a><span class="m">27108398</span><span class="w">      </span>multinode<span class="w"> </span>amd-hdr100<span class="w">      </span>USER<span class="w">          </span><span class="m">4</span><span class="w">          </span><span class="m">2</span><span class="w">  </span>COMPLETED<span class="w">      </span><span class="m">0</span>:0
<a id="__codelineno-27-6" name="__codelineno-27-6" href="#__codelineno-27-6"></a><span class="m">27108398</span>.ba+<span class="w">      </span>batch<span class="w">                 </span>USER<span class="w">          </span><span class="m">3</span><span class="w">          </span><span class="m">1</span><span class="w">  </span>COMPLETED<span class="w">      </span><span class="m">0</span>:0
<a id="__codelineno-27-7" name="__codelineno-27-7" href="#__codelineno-27-7"></a><span class="m">27108398</span>.ex+<span class="w">     </span>extern<span class="w">                 </span>USER<span class="w">          </span><span class="m">4</span><span class="w">          </span><span class="m">2</span><span class="w">  </span>COMPLETED<span class="w">      </span><span class="m">0</span>:0
<a id="__codelineno-27-8" name="__codelineno-27-8" href="#__codelineno-27-8"></a><span class="m">27108398</span>.0<span class="w">         </span>pw.x<span class="w">                 </span>USER<span class="w">          </span><span class="m">4</span><span class="w">          </span><span class="m">2</span><span class="w">  </span>COMPLETED<span class="w">      </span><span class="m">0</span>:0
</code></pre></div>







  
    
  
  


  <aside class="md-source-file">
    
      
  <span class="md-source-file__fact">
    <span class="md-icon" title="Last update">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M21 13.1c-.1 0-.3.1-.4.2l-1 1 2.1 2.1 1-1c.2-.2.2-.6 0-.8l-1.3-1.3c-.1-.1-.2-.2-.4-.2m-1.9 1.8-6.1 6V23h2.1l6.1-6.1-2.1-2M12.5 7v5.2l4 2.4-1 1L11 13V7h1.5M11 21.9c-5.1-.5-9-4.8-9-9.9C2 6.5 6.5 2 12 2c5.3 0 9.6 4.1 10 9.3-.3-.1-.6-.2-1-.2s-.7.1-1 .2C19.6 7.2 16.2 4 12 4c-4.4 0-8 3.6-8 8 0 4.1 3.1 7.5 7.1 7.9l-.1.2v1.8Z"/></svg>
    </span>
    <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date">September 27, 2024</span>
  </span>

    
    
    
    
  </aside>





                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2021-2024 The University of Alabama at Birmingham.<br /><b>Still stuck after reading?</b> Email us at <a href="mailto:support@listserv.uab.edu" class="supportemail">support@listserv.uab.edu</a>
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../../..", "features": ["navigation.indexes", "navigation.instant", "content.code.copy"], "search": "../../../assets/javascripts/workers/search.c011b7c0.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../../assets/javascripts/bundle.7389ff0e.min.js"></script>
      
        <script src="../../../javascripts/mathjax.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  <script>document$.subscribe(() => {const lightbox = GLightbox({"touchNavigation": true, "loop": false, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom", "slideEffect": "slide"});})</script></body>
</html>